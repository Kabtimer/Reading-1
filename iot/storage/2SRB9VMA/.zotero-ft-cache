sensors
Article
Performance Evaluation of LoRa Considering Scenario Conditions
Ramon Sanchez-Iborra 1,* ID , Jesus Sanchez-Gomez 1, Juan Ballesta-Viñas 2, Maria-Dolores Cano 2 ID and Antonio F. Skarmeta 1 ID
1 Department of Information and Communication Engineering, University of Murcia, 30100 Murcia, Spain; jesus.sanchez4@um.es (J.S.-G.); skarmeta@um.es (A.F.S.)
2 Department of Information and Communication Technologies, Universidad Politecnica de Cartagena, 30202 Cartagena, Spain; juanballesta1992@gmail.com (J.B.-V.); mdolores.cano@upct.es (M.-D.C.)
* Correspondence: ramonsanchez@um.es; Tel.: +34-968-884-644
Received: 29 December 2017; Accepted: 1 March 2018; Published: 3 March 2018
Abstract: New verticals within the Internet of Things (IoT) paradigm such as smart cities, smart farming, or goods monitoring, among many others, are demanding strong requirements to the Radio Access Network (RAN) in terms of coverage, end-node’s power consumption, and scalability. The technologies employed so far to provide IoT scenarios with connectivity, e.g., wireless sensor network and cellular technologies, are not able to simultaneously cope with these three requirements. Thus, a novel solution known as Low Power - Wide Area Network (LP-WAN) has emerged as a promising alternative to provide with low-cost and low-power-consumption connectivity to end-nodes spread in a wide area. Concretely, the Long-Range Wide Area Network (LoRaWAN) technology is one of the LP-WAN platforms that is receiving greater attention from both the industry and the academia. For that reason, in this work, a comprehensive performance evaluation of LoRaWAN under different environmental conditions is presented. The results are obtained from three real scenarios, namely, urban, suburban, and rural, considering both dynamic and static conditions, hence a discussion about the most proper LoRaWAN physical-layer conﬁguration for each scenario is provided. Besides, a theoretical coverage study is also conducted by the use of a radio planning tool considering topographic maps and a precise propagation model. From the attained results, it can be concluded that it is necessary to evaluate the propagation conditions of the deployment scenario prior to the system implantation in order to reach a compromise between the robustness of the network and the transmission data-rate.
Keywords: LP-WAN; IoT; Smart cities; LoRa; LoRaWAN

1. Introduction
Low Power - Wide Area Networks (LP-WAN) have emerged as one of the most promising Internet of Things (IoT) enabling technologies due to their advantages over other solutions such as short-range transmission technologies (e.g., WiFi, Bluetooth, IEEE 802.15.4-based protocols, etc.) or cellular communications [1,2]. This fact is motivated by the different requirements that current and future IoT systems present in comparison with traditional Wireless Sensor Networks (WSN) or cellular systems. These conceptual differences between the IoT, WSN, and cellular-network paradigms are presented in Table 1. Observe that, basically, the main characteristics and requirements that an IoT system presents are: (i) a reduced use of bandwidth; (ii) a limited number of messages per node per day; (iii) huge number of simultaneously-connected end-devices; (iv) long-range links; and (v) low-cost end-devices. The majority of these features are satisﬁed by the different LP-WAN platforms in the market [3]; however, they present important differences mostly related to their network architecture and the adopted business model. In this work, the focus is on LoRaWAN (Long-Range

Sensors 2018, 18, 772; doi:10.3390/s18030772

www.mdpi.com/journal/sensors

Sensors 2018, 18, 772

2 of 19

Wide Area Network) [4], which is a platform promoted by the LoRa Alliance (IBM, Semtech, and Cisco,

among others), positioned together with Sigfox [5] at the top of the rank of platforms receiving

more attention from both the academia and the industry [1]. Although both of them offer similar

features to their users, each one takes different technological approaches. On the one hand, Sigfox

presents a highly closed and limited transmission scheme with very few adaptation capabilities as it

employs a proprietary ultra-narrow band technology with a maximum uplink data-rate of 100 bps and a maxSeinmsorus 2m018,p18a,cxket-payload of 12 Bytes. As the majority of the LP-WAN plat2foofr2m0 s, Sigfox

uses the Inredlautesdtrtioatlh,eSircnietnwtoiﬁrkc,arachnidtecMtureedaincdalth(eISadMop)tesdubbu-sGinHeszs mfroedqeul. eInncthyisbwaonrkd,sthseof,ocduus eis toon the strict

duty-cycleLoliRmaWitAatNio(nLsonigm-RpaonsgeedWbidye wAroeraldNwetiwdoerkr)e[g4u], lwathiiocnh si,s taheplantfuomrmbeprroomfotterdanbsymthisesLiooRnas is highly restricted;Athfolelirraanencxkeao(mIfBpMplal,tefSo,ermimntseErcehuc,eraiovnpidnegC,miascoomr,eaaamxttoeimnntgiuoonmthfreoormsf),1bp4oo0tshimttihoeenasecdsaatdgoegemestihapeaernrwdeitthnhedSin-igndfuoosxdtr[ey5]p[1ae]t.rtAhdletahtooypuagorhfe allowed. Neverthelebsosth, doef sthpeimteotfhfeersseimteilcahr nfeoatluorgeisctaoltlhiemiriutasetiros,nesa,chSiognfeotxakiseshdaifvfeinregntgtreechantosluogciccealssapdpuroeactoheist.s business

and architOecntuthreeomneohdaenldt, hSaigtfocxopnrseissetnstsoaf ahigwhilydeclonseedtwanodrklimofitebdastrea-nsstmatisisoionns sccohvemereinwgithgvrerayt fpewart of some

European atdearprtiattoiorniecsapaanbdilitiaesbaascitkehmapulloynseatwprooprrkiettahraytulptrear-nmarirtoswtobadndeltievchenrotlhogey cwoilthleactmeadxidmautma from the edge-netwuWoprAlkiNnktpodlaatthtfaoe-rrmactleso,ouSfidg1f0oa0xlmbupsosessatnthdweaiItnmhdaurxseitmdriauulm,cSepcdiaecnlkateitftei-cpn, aacynyld.oaTMdheoedfric1ea2floB(IrySetMe,st).hsAuesbet-hGneHdm-zuafjrsoeerqirutsyeanocrfyethboeannLldPys- in charge of acquirinsog, adnude tionstthaellsitnrigct tdhuetye-ncydc-ledelivmiictaetsio, nbsecimauposseeddabtya-wtroarlndswpidoertreagnudlatiitosnps,rtehseennutamtbioern oifs in Sigfox

hands, whtircahnsnmoistsaibonlys ies ahsigehslythreestmricatenda;gfoermexeanmtptlae,siknsEfurroompe,tahmeauxsimerumsidofe1.40 messages per end-node

per day are allowed. Nevertheless, despite these technological limitations, Sigfox is having great

Table s1u.ccSetsrsadteugeytocoitms bpuasriniseossnaanmd oarncghitceecltluurlearmcoodmel mthuatnciocantsiiostnsso,fWa iwreidleesnseStwenorskorofNbeatswe-sotraktison(W s SN),

and

IncctooevlrleenrceitntegdofgdrTaethaaitnfprgoasmrt(oItohf eTso)emdsygeesE-tneuemrtowsp.oearkn

territories and a backhaul network that permits to deliver the to the cloud almost with reduced latency. Therefore, the end-

users are only in charge of acquiring and installing the end-devices, because data-transport and its Ceplrluesleanr tCatoimonmisuinnicSaigtifoonxshands, which notablyWeaSsNes the management tasks from the uIsoeTr side.

High bandwidth

Limited bandwidth

Limited bandwidth

CoTnatibnleuo1.uSstrtartaefgﬁyccomparison among celluSlpaor rcaomdimc utrnaifcﬁatcions, Wireless Sensor NetwSoprokrsa(WdiScNtr)a, afﬁndc

LimitedInnteurmnebt eorf Tohf idnegvs i(cIoeTs ) systems. High number of devices

Huge number of devices

ExpensivSemnCaeellltlwuaHlroaiegrrahkCcobaemannllmddswudnideictvhatiicoenss ReducedVenLrieymtwistemodWrabkSlalNnacdnowdvidedtrheavgieces costs ReLdimuicteeddIbonWaTentdiwdweoidratkhreaancdeldlsevice costs

Continuous traffic

Sporadic traffic

Sporadic traffic

Limited number of devices

High number of devices

Huge number of devices

In turn, LoRaWSmAalNl are[a4c]elplsresents a moreVearydsvmaalnl ccoevedrasgeolution that peWrmideitasreathceellsend-user to adapt the

system to her nExepeednssiv.eSneptweocrikﬁacnadldleyv,icLesoRaRWedAucNed ndeetwﬁonrkeasndthdeeviOcesScIo’ssts(OpReenducSeyd snettewmorksaInnd tdeevricceocnosntsection) Physical

(PHY) and MeIdnituumrn, ALocRcaeWssACNo[4n]tprorelse(MntsAaCm)olraeyadevrsan(cpeldesaosleu,tisoenethFaitgpuerrmei1ts).thIenenthde-uPseHr tYo aldaaypetrt,hLe oRaWAN
employs thseyisrteomwtno-dheervneeloedpse. dSpmecoifdicualllayt,ioLnoRsacWheAmNed, esfoin-cesaltlheedOLSoIR’sa(O(LpoenngSyRstaenmgseI)n, twerhcoicnhneicstiaonp)roprietary technologyPhbyassiceadl (oPHnYa) CanhdirMpeSdipurmeaAdccSepsseCcotrnutrmol ((MCASSC)) mlayoedrsu(lpaletaiosen, steheaFtigpuerrem1)i.tIsnltohwe P-pHoYwlaeyrerl,ong-range
LoRaWAN employs their own-developed modulation scheme, so-called LoRa (Long Range), which
transmissiios nasp.ropOrinetatrhyeteMchnAoClogylabyaesre,d LonoRa aCWhirAp NSprdeaedﬁSnpeesctrtuhme (cCoSSm) mmoudnuilactaiotniotnhatppreortmoictsollo, wth- e system architecturpeo,waernldonog-trhanegresterarnvsimceisssioannsd. OinnttheerMfaAcCeslayfoerr, LhoiRgahWeAr-Nladyeefirneaspthpeliccoamtmiounnsic.atBioontphroltaocyoel,rs present
some custothme iszyastbemle asrecthtiitnecgtusrteh, aantdportohveridseervthiceessaynsdteinmterwfaictehs faorvhailguhaerb-llaeyﬂereaxpipbliilciattyiotnos.aBdoathpltayitertso different use cases. pFruesretnhtesrominescigushttosmaizbaobuletsLetotiRngas athnadt pLroovRidaeWthAe Nsysaterme pwriothvaidveadluaibnlesuflebxsibeiqliutyetnotasdeacpttiiotntos.
different use cases. Further insights about LoRa and LoRaWAN are provided in subsequent sections.

Figure 1. Long Range Wide Area Network (LoRaWAN) stack.
Figure 1. Long Range Wide Area Network (LoRaWAN) stack.

Sensors 2018, 18, 772

3 of 19

The main motivation of this work is characterizing LoRaWAN PHY layer features in order to be able to select the most proper conﬁguration depending on the conditions of the deployment scenario. Concretely, the focus is on a mobile scenario in which the end-node is placed onboard a vehicle; these conditions are similar to those of services that have been lastly associated to this type of radio technologies, such as ﬂeet tracking, goods monitoring, or vehicle state control, among others [6,7]. As a ﬁrst step, a theoretical coverage study is presented by means of the expected power-level maps obtained from an accurate radio-network planning tool [8], which makes use of topographic maps and the widely-used Okumura–Hata propagation model. Thereafter, this coverage study is validated by comparing its predictions with the outcomes attained in an experimental sampling campaign. Previous works have demonstrated the need of contrasting the predictions of IoT network planning tools with the results extracted from real experiments [9]. Therefore, in the following sections, a comprehensive exploration of LoRaWAN is conducted by examining its performance under different conﬁgurations in different mobile scenarios, namely, urban, suburban, and rural. With the aim of completing this study, in addition to this evaluation under mobility conditions, a nomadic test has been also conducted in the same scenarios in order to ﬁnd performance differences between them.
The main contributions of this work are the following:
- An exhaustive evaluation of LoRaWAN with emphasis in its adaptation capabilities is presented. - The performance of LoRaWAN in different environments with pre-deﬁned propagation
conditions, namely, urban, suburban, and rural is explored. The impact of end-node mobility on the system performance is also discussed. - Under this diversity of scenarios, the best LoRaWAN conﬁguration for each use case is identiﬁed and discussed.
The rest of the paper is organized as follows. In Section 2, a review of the most prominent works regarding the evaluation of LoRaWAN deployments is presented. Section 3 introduces the main foundations of LoRa and LoRaWAN. The methodology, tools, and equipment used in this work are described in Section 4. Section 5 presents and discusses the results obtained from both the theoretical coverage study and the experimental campaign. Finally, Section 6 concludes this work, presenting the most important ﬁndings.
2. Related Work
Although the appearance and widespread of LoRaWAN are recent, a number of works have been published aiming at analyzing or evaluating its performance in different scenarios or proposing enhancements to the off-the-shelf version of LoRaWAN [7,10–19]. From a theoretical perspective, works in [10–12] analyzed the capacity of LoRaWAN in terms of scalability and node-throughput. All these works concluded that LoRaWAN systems should be carefully conﬁgured and dimensioned with the aim of hosting a great number of end-devices. Concretely, in [10], the negative impact of interferences within highly-populated LoRaWAN cells was studied. Authors found some issues related to the co-spreading sequence interference, which notably harms the scalability of LoRaWAN systems. However, as stated in [11], LoRaWAN networks can be generally utilized for fairly dense deployments with relaxed latency or reliability requirements. Thus, in order to ensure the network scalability when the end-device population prominently grows, two measures can be taken: (i) the number of delivered packets per node per day should be reduced; or (ii) the number of gateways should be increased [12].
As mentioned above, some works have proposed enhancements to the original LoRaWAN features [13,14]. In [13], authors presented a solution to improve the overall security of a LoRaWAN-based IoT system. This proposal employed proxy-nodes for performing the cryptographic operations in order to avoid heavy computation in the constrained end-nodes. In turn, work in [14] presented an integration of IPv6 into LoRaWAN. Similar to the case of 6LoWPAN, this solution permitted a higher interoperability of the IoT network with the outside world. Although interesting,

Sensors 2018, 18, 772

4 of 19

both works lacked of a detailed performance evaluation to demonstrate the impact of their proposals on the system operation.
From a different perspective, other studies presented the results extracted from experimental tests conducted in diverse scenarios and situations [15–19]. These works focused on evaluating the performance of LoRaWAN under different propagation and environmental conditions. For example, in [15], a real LoRaWAN deployment was evaluated and it was found that the base-station antenna location and elevation have great importance in the network performance. The measurements were carried out using three different base-stations. A similar experimental study was elaborated in [16]. In this case, authors focused on tuning the LoRaWAN PHY layer, i.e., LoRa, conﬁguration parameters, identifying both Spreading Factor (SF), which will be explained later in detail, and data-rate as the principal factors impacting on the network coverage. Another coverage study focused on LoRa, was presented in [17], but, in this case it was carried out in an indoor scenario. The presented outcomes demonstrated the robustness of LoRa in adverse industrial environments, even with high data-rates. In turn, authors of [18] investigated the coverage of LoRaWAN in different environments by placing the end-device onboard a car and a boat. Interesting coverage ranges over 10 km were reached with a not excessive Packet Loss Rate (PLR). A more elaborated work was developed in [19], in which the same authors extended their measurements and evaluated the performance of the system under mobility conditions. From a simulation perspective, the work in [7] focused on vehicular scenarios and examined the performance of LoRaWAN in vehicular opportunistic networks, showing better results in comparison with WiFi technology.
As observed in the reviewed works, the coverage range and the performance of different LoRaWAN conﬁgurations were evaluated. However, these studies did not characterize the sampling points depending on their adversity against wireless transmissions. In this work, we evaluate the performance of LoRaWAN under three well-deﬁned conditions, namely, urban, suburban, and rural scenarios. By using this methodology, we identify the most proper conﬁguration for LoRaWAN PHY layer parameters in order to reach the best performance in each type of scenario. Besides, a comparison of the attained experimental results with a theoretical propagation model is also presented. A similar approximation was considered in [18] but, in this work, the attained coverage range was compared with the predictions given by the simple Free-Space model. This model is known to be inadequate to predict path loss in complex scenarios like those with the presence of obstacles. For that reason, in the present work, we make use of the predictions provided by a network-planning tool employing the widely used Okumura–Hata propagation model over realistic topographic maps.
3. LoRaWAN
As explained in previous sections, the LoRaWAN framework deﬁnes two well-differentiated layers, the PHY layer, deﬁned by the LoRa modulation, and the MAC layer, deﬁned by the LoRaWAN protocol. Regarding the former, LoRa is a proprietary spread spectrum modulation scheme that derives from Chirp Spread Spectrum (CSS) modulation that focuses on providing robustness to long-range transmissions. LoRa presents three different conﬁgurable parameters, namely, Spreading Factor (SF), Coding Rate (CR), and Bandwidth (BW). By tuning these factors, some of the end-to-end communication features can be adjusted, e.g., data-rate, error-correction capability, and transmission range, among others. Regarding the SF, the spread spectrum modulation is performed by representing each bit of information by multiple chips [4]. Thus, the SF represents the ratio between the chip rate and the baseband information rate. Usual SF values range from 7 to 12, so greater SF values increase the robustness of the transmission link by incrementing the receiver-equipment sensitivity at the expense of the transmission data-rate. On the other hand, by decreasing the SF, the data-rate is notably increased but the transmitted signal needs to be received at higher power-level for its properly decoding. Note that a complementary notation to the SF is the so-called Data Rate (DR); in this case, the scale is reversed, so DR0 is equivalent to SF12, and DR5 is equivalent to SF7. From now on, the term DR will be used. With the aim of additionally improving the robustness of the link, LoRa

Sensors 2018, 18, 772

5 of 19

employs cyclic error coding to perform forward error detection and correction. Such error coding

Sensors 2018, 18, x

5 of 20

incurs a transmission overhead (extra bits in the LoRa PHY layer payload) that is determined by the

4C/R7, panarda4m/8e.teFri,nwalhlyic, hthceamn obset seemt ptolotyheedfBolWlowininLgoRvaalturaesn,s4m/i5ss, i4o/n6i,s41/275, kaHndz,4a/lt8h.oFuignhalblya,ntdhwe imdtohsst oefm2p5l0oykeHdzBaWndin50L0oRkHa tzraanresmalissosisounpips o1r2t5edk.HMz,oarlethdoeutagihlsbaabnoduwt iLdothRsaocfa2n5b0ekfHozunanddin50[40]k. Hz are also suppForrotemd.aMhoirgehdeer-tlaaiylsearbpoeurtsLpoeRctaivcea,nLboeRfaoWunAdNine[m4]p. loys a star-of-stars topology that permits end-nFordomes arehacighhinegr-lathyeeirr pceorrsrpesepctoinvde,inLgoRgaaWtewAaNy evmiaplaoydsiraecsttalrin-okf-s(staeres Ftoigpuorleog2y). thDautepteormthites eennedr-gnyo-dreelsatreedacchoinnsgtrathinetisr ocfoerrneds-pnoonddeisn,gLPg-aWteAwNaytevcihanaolodgirieesctplriensken(tseaehFigighulyrelim2)i.tedDduoewtonlitnhke (etnraenrgsmy-irsesliaotneds fcroonmsttrhaeinbtassoef-setnatdio-nnoddoews,nLtPo-WenAdN-notedcehsn),ohloegniceesLporResaeWntAaNhcigohnltyemlipmlaitteeds tdhoewunsleinokf t(htrraenesdmifisfesrioennst tfyropmestohfe ebnadse-d-setvaitcioens adcocworndtinogentod-tnhoedirese)n,ehregnycelimLoitRaatiWonAsNancdondtoemwnplloataedsinthgenueseedos:f Cthlareses dAiffdeerveinctestyaprees joufstenadbl-edetvoicreesceaicvceotrrdainnsgmtoisstihoenirs eanfteerrgyealcimh iutaptliionnkscaonndnedcotiwonnlobaydoinpgennienegdas: lCisltaesnsiAngdewviincedsoawre. jCuslat sasblBe toderevciceeivseatrraenasbmleisstioonascaceftpetr edaocwh nulpinliknktcraonnsnmecitsisoinonbsy odpuernininggaadldisitteionninagl swchineddouwle.dCdloawssnBlindkevwicinesdoawres.aFbilneatlolya, cCcleapsts dCodwenvliicneks tarraencsomnitsinsiuoonussdlyulriisntgenaindgdittoiotnhael cshcahnendeullesod tdhoewy ncalinnkrewceiinvdeodwosw. nFliinnakllcyo,nCnleacstsioCnsdaetvaicneys taimreec.oTnhteinmuooustsleymlpisltoeyneidngdteovitchees,cChlaansnseAl ,sportehseeyntcaann orepcteimiviezdedowbnatltinerkycdonunraetcitoionnosfaatbaonuyt t5imyee.arTsh[e4m]. oInstitesmrpeglouyleadr udseev,icLeosR, CaWlasAsNA,mparekseesnut saenoofptthime IizSeMd bbaanttdesr,yadltuhroautigohnitofcaanbobuetc5onyfeiagrusre[4d].toInsuiptsproergt ulilcaernusesed, sLpoeRctarWumANasmwaeklle.sTuhseereobfyt,hLeoIRSaMWbAaNndiss, caaltphaobuleghofitdceamnobdeucloanteﬁsgiugrneadlstorescuepivpeodrt19li.c5endsBedbeslpoewcttrhuemnaosiswe efllol.oTr.hTehreisbya,llLoowRsaWtoAaNchiiesvciaepvaebrlye loofndgetmraondsmuliastseiosnigdniastlasnrceecseifvaerdfro1m9.5thdoBsebreelaocwhetdhebynothiseeuﬂsuooalr.ceTllhuilsaraltleocwhnsotloogaicehs.ieDveiepevnedryingloonng tthraencsomnifsigsiuornatdioinstaonf cPeHs Yfalrayfreormpatrhaomseetreerasc, htheeddbaytat-hraeteusruanalgecselflruolmar 0te.2c5hnkoblposg(i0e.s9.8DkbeppesnindiNngorothn Athme ecroincaﬁgduuraetitoon FoCf PCH(YFeldayerearlpCaroammmetuenrsi,cathtieondsataC-oramtemriasnsigoens)frloimmit0a.t2io5nksb)pusp(0.t9o8 k50bpksbipnsN. oTrhthe mAmaxeirmicuamdupeetromFiCtteCd(FpeadyeloraaldCloemngmthunisic2a4t2ioBnys tCeos,mwmhiiscshioanl)thliomuigtahtiloimnsi)teudp, tmoa5y0 skabtpissf.yTthheemdaexmimanudms opfercmerittatiendsperavyilcoeasd. Fleinnagltlhy,iLs o2R42aWByAteNs,awlshoicchonaslitdheorusgshecluimriittyedis,smueasy, ssoataiscfyrytphteogdreamphanicdssuoitfecberatsaeidn osenrvAiEceSs.enFcinryaplltyi,oLnoiRs aiWncAluNdeadlsboycodnesfaidueltrsinseocrudreitrytoisssueecus,resothaecrtryapntsomgritatpehdicdasutaitaetbdaisfefedreonnt AOESSI leenvcerlysp. tion is included by default in order to secure the transmitted data at different OSI levels.

End-device LoRaWAN gateway Network service

LoRaWAN link Broadband link

FFiigguurree22..LLooRRaaWWAANN ssttaarr--ooff--ssttaarrss ttooppoollooggyy..

44.. MMaatteerriiaall aanndd MMeetthhooddss
AAss ssttaatteedd aabboovvee,, tthhee ppeerrffoorrmmaannccee ooff LLooRRaaWWAANN PPHHYY llaayyeerr hhaass bbeeeenn tteesstteedd iinn ddiiffffeerreenntt sscceennaarriiooss cchhaarraacctteerriizzeedd bbyy tthheeiirr lleevveell ooff aaddvveerrssiittyy aaggaaiinnsstt wwiirreelleessss ttrraannssmmiissssiioonnss.. RReeccaallll tthhaatt tthhee ccoonnfﬁigguurraabbllee ppaarraammeetteerrss ooff LLooRRaaWWAANN PPHHYY llaayyeerr wwhheenn uussiinngg tthhee LLooRRaa mmoodduullaattiioonn aarreeSSFF,, CCRR,, aanndd BBWW.. NNoottee tthhaatt tthhee GGFFSSKK(G(aGuasusisasniaFnreqFureeqnucyenSchyiftSKheifytinKg)emyinodg)ulamtioodnu, alalstoioanv,aialalsbole ainvathileabLloeRainWAthNe spLeocRiﬁacWatAioNn, shpaescnifoictabteioenn,choanssindoetrebdeeinn tchoisnswidoerrkeadsiint hthasisdwemoroknsatsraittehdaps odoermeropnesrtfroartemdanpcoeoirnercopmerpfoarrmisoanncwe iitnh comparison with LoRa [2]. These tunable parameters affect the data-rate and the Packet Delivery Rate (PDR) of the transmissions as showed in the cited previous study [2]. In our study, the possible values that were assigned to the different parameters under consideration were: (i) SF: 7 to 12; (ii) CR: 4/5 and 4/8; and (iii) application payload size: 20 and 40 bytes.

Sensors 2018, 18, 772

6 of 19

LoRa [2]. These tunable parameters affect the data-rate and the Packet Delivery Rate (PDR) of the
transmissions as showed in the cited previous study [2]. In our study, the possible values that were
assigned to the different parameters under consideration were: (i) SF: 7 to 12; (ii) CR: 4/5 and 4/8;
and (iii) application payload size: 20 and 40 bytes.
LSeonRsorasW201A8,N18,txransmissions make use of the unlicensed ISM bands, so the European Lo6 Rofa2W 0 AN
end-devices must comply with the ETSI 300 220 regulation. This regulation enforces a duty-cycle policy on channeLlosRfoaWr eAvNerytrasnusbm-bisasniodn. sTmheakLeouRsaeWofAtNheduenflaicuelnt scehdanISnMelsb,annadms, esloy,th8e68E.1u,ro8p6e8a.3n, LanoRda8W68A.5NMHz utessetsa,ep8tBn6oh8Wdlei.-c5d8yoMe6fov7Hni1.c12zec,5sh8uak6msne7Hun.a3szet,l.Bs8cBW6foeo7msro.i5pefd,lv1ye8e2s6rw5,y7oik.ts7tHhuh, bzaeth.-nrbeBdcaehnEs8adTi6dn.S7eTIn.s9he3, el0Mos0tLhcH2oea2Rrzn0accbWhrheeaagAnmnunNnleaaelndtslieouscfnaawa.nluleTylbtrheeccishoemanmrnaeﬁngnpguueluollasaryl,tleyeinoddancmbobenyeenflcitfygaho,uure8crs6eeue8sds.t1eahb,rye,d8yhu6th8etwy.en3-ec,cureyasecneflrfdoer,reeouorf otherhternacnesfmorisosuior ntesstdsu, trhineg86t7h.e1,s8a6m7.3p,li8n6g7.5c,a8m67p.7a,igannd. T8h67e.9chMaHnnz eclheamnnpellsoyweedrebeymtphleoyeenddb-deceavuiscee was randothmeylywseerleecftreede ofof rotehaecrhtrtarnasnmsmissiisosnios nd.uring the sampling campaign. The channel employed by the
Ienndo-rddeevricteowpaesrfroanrmdomthley ﬁseelledctteedstfos,r feoalclhowtraingsmthisesiaonrc.hitecture adopted in our previous work [2],
the LoRaWInAorNdeerntod-pneorfdoermwtahse pfilealdcetdestosn, ftohlleowroinogf tohfeaarccahri,tefoctrumreinagdoppaterdt oinf oaunrOprne-vBioouasrdwUornki[t2(]O, BU) that dthiereLcotlRyaWcoAmNmeundn-incoadteedwwasitphlacthede oLnotRheaWroAofNof baacsaer-,sftoartmioing. pTarhteofmanicrOonc-oBnotarrodllUerniut (sOedBUi)n the OBUtwhaatsdtihreectAlyrdcouminmou-cnoicmatpedatwibilteh Sthme aLrotREavWerAyNthibnagseF-sotaxtiboona. rTdhebmy iAcrrorcoown.trCololenrnuescetdedinttohethOaBt Uboard, the LwoRasaWthAe NArrdaudinioo-mcoomdpualteibwleaSsmtharetERvNer2y4t8h3incghFipoxbbyoMardicrboychAirprowwi.thCoannnoecmtendidtoirethcatitobnoaalrd5,dtBhei-gain antenLannoatRefanoWnraAenfNodr-rdaeednvidoi-cdmeesov,diwcuehlse,icwwhahwsicathhsekwReapNst2pk4eo8p3intcthpiniopginbutiypnwgMaiucrprdowsc,ahfriapdvswo, rifitanhvgoarntihnoegmretnhcieedpirrteeiccotenipogtniaoalinn5g(dsaeBinei-Fg(saigeineure 3). The tFraignusrcee3iv).eTrhcehtripanwscaeisvearCchlaipsswAas LaoCRlaasWs AALNoRdaeWviAceNwdeitvhiceanwiothutapnuotuptpouwt perowuepr tuop1to4 1d4BdmBm. .Thus, obserTvheutsh, aotbosnerlvyeLothRaat WoAnlNy cLoomRamWuAnNicactoiomnms uwneicraetieonnasbwleedreinetnhaeblOedBUin. Tthhee OOBBUU.mTihcreocOoBnUtroller boardmhicarodcoanntreomllebrebdodareddhGadloabnaelmPboesditdioedniGnlgobSayl sPtoesmitio(GniPngS)Sycshtiepmt(hGaPtSt)hcehidpetvhiactethuesdedevticoe oubsetadin its locatitono.btIaninaditds iltoicoantioton.tIhneaednddit-idonevtioceth, etheendo-tdheevricceo, mthme uotnhiecratcioomnmeunndi-cpatoioinnt,eni.de-.p, othinet,bia.es.,e-tshteation,
emplobayseed-sthateioRnH, eFm2Sp0lo0y8ebdotahredRbHyFR2Sis0i0n8gbHoFa,rwd hbiychRiisninclguHdFe,swahSicehmitnecclhudSeXs1a30S1emchteicph. TSXh1is30m1ocdhuiple. was capabTlheiosfmdoedcuodleinwgasupcatpoa8bldeiofffedrencotdreincgeputpiotnos8indidffieffreernetnrtecehpatnionneslsinemdipffleoryeinntgchaannynSeFls, seimmpuloltyainnegously. ConsaidneyriSnFg, sthimesueltarincehoufeslayt.uCreosn,soidnelyrinognethbeaseser-iscthatfieoantuwreass, uonselyd oinnethbeaseex-psteartiiomnewntaasl tuessetds;ian stehcetorial antenenxapeorfim8ednBtailgtaesints;aandseactfoarria-ﬁl aenldtebnenaamof-w8 iddBtihgoafin65anddegarfeaers-fiweladsbaetatmac-hweiddtthootfh6e5pdreogcreesessinwgabs oard (see FainitgtaTucarhbeelde4)t2.o. tTAhheespubrmoascmee-ssastiranytgioobnfoarterhdleay(seeeqdeuFtihipgemupreaenc4kt)e.ctAsonsbuﬁamcgkumaranardtyioofonfrttihhsetseohqouthwipemnLoeinnRtaTcWoanbAflNiegu2nr.eattTwiohoneriksbssaehsroevw-esrnt,ation relayhedentcheethpeabcakseet-sstbataicokn aacntdedfoarstah gtoatethweayLobeRtawWeeAnNthenectowntororkllesrearnvdert,hheeenncde-dtheveicbea. sIen-stutarnti,otnheacted as a gnaettewworakysbeervtweremenantahgeedcotnhteroenllde-rdaenvidcethloegienndan-ddeavcikcneo.wInledtugrenm,etnhte(AnCetKw)olorkgicsserdveefirnmedainnatgheed the end-dLeovRiacWe lAoNginspaencidficaactkionno[w4]l.edgement (ACK) logics deﬁned in the LoRaWAN speciﬁcation [4].

FiFgiugurere33. .OOnn--bbooaarrdd uunnititddeteatial.il.

SensoSrsen2s0or1s82, 01188,,71782, x

7 of 20 7 of 19

(a)

(b)

FiFgiugurere44. .BBaassee--ssttaattiioonnddeetataili.l(.a()aC) oCnotrnotlrloerl,le(br;)(Abn) tAennntae.nna.

TaTbalebl2e. 2S.uSmummmaarryyooff tthhe eqquuiippmmeennt tcocnofnigﬁugruatriaotniofnorfaorBWa BoWf 12o5f k1H25z.kHz.

Output Power

Antenna GOauintput Power

Central frequAenntceynna Gain

RX RX

SSeennssiittiiRRvvCiiXXttyyeSSnSSeetFFnnrass==iiltt78fiirvveiiqttyyuSSenFFc==y

7 8

RX SensitiRviXtySSeFns=it9ivity SF = 9

RX SensitiRviXtySSeFns=it1iv0ity SF = 10

RX SensitiRviXtySSeFns=it1iv1ity SF = 11

RX SensitiRviXtySSeFns=it1iv2ity SF = 12

EnEdn-Dd-eDviecveice Base-StatioBnase-station

+14 dBm

+14 dBm

+14+d5BdmBi +14 dBm +8 dBi

+856d8BMi Hz +8 dBi 868 MHz

−−8116−−228113622..M0036..ddH00BBzddmmBBmm

−−811622869..M50 ddHBBzmm−−112269..50

dBm dBm

−1−2192.09.d0BdmBm −131.5 dBm−131.5 dBm

−1−3123.02.d0BdmBm −134.0 dBm−134.0 dBm

−1−3133.03.d0BdmBm −136.5 dBm−136.5 dBm

−1−3163.06.d0BdmBm −139.5 dBm−139.5 dBm

Besides, the network server also ruled the downlink queue for managing the different hBigehseidr-elas,ytehrepnacektwetsoarkndseitrvsteorraedlsothreuflreadmtehseredcoewivnedlinfrkomqutehueeOfBoUr masawnaeglli.ng the different higher-layer packets aNnodwitthsatot rtehde hthaerdfwraamreessertuepcehivaesdbefernomdetshcreibOedB,Uneaxstwtheellb.ehavior of the involved devices is pNreosewnttehda. Tt hthe eOBhUaradcwteadraes saeptuerpiohdiacssebnedeenr hdeensccerinboeodt,hnereexltemtheentbseohrasevniosorros fbetyhoenidntvhoelsvteridctldyevices is prneesceensstaerdy. wTehree iOnvBoUlveadctinedthaesteastps.eTrhioedoivcesraelnl dfuenrchtieonicnegnwoasoaths eforlleolwems. eFnirtsst,othresOenBsUorosbtbaeinyeodnd the
stricittlsyGnPeSceloscsaatrioynwaenrdetirnavnsomlvitetdedina tphaecktetstws.itThhtheeocvoeorradlilnfautenscitnioclnuidnegdwinasthaespfaoyllooawdsf.ieFlidr.sAt,ftthere OBU obtatirnaendsmiittstinGgPeSaclhocpaatcikoent,athnedOtBraUnwsmaiittetdedforaapnaAckCeKt fwroimthththeebacsoeo-srtdaitnioanteussiinngctlhuedfeirdstirnectehievinpgayload ﬁeldw. iAndftoewr strpaencisfmiedittinintgheeaLcohRapWacAkNetp, rtohteocOolB(Uplewasaei,tesdeef[o4r]).aFnoAr eCaKchftrroamnsmthisesiboans, ea-sdtiaffteiroenntusseitng the ﬁrstorfetcheeivLionRgawWiAnNdocwonsfpigeucriaﬁtieodn ipnatrhame eLtoerRs,aWi.eA., NSF,pCroRt,oacnodl (BpWle,awsea,sseemep[4lo]y).edFoforrebaochthturapnasnmdission, a difdafsoewdreennscltirnsibkeestd.oTifnhti[sh2ep0r]L.oTcoehRsisasWwstarAastNpeegrcyioopndeﬁircmgaluiltyrteardteipotoenattepesdatrddauimfrfeienrtegenrtthsL,eoid.Reu.ar,acStoiFon,nfCigoRuf r,thaateniotdenssBt siWnima,unwltiaannsfieneoimutespllyolooiypned for boththuepdaifnfedrednot wscennlairniokss.unTdheirs cpornoscidesesrawtioans. pInertihoisdipcraolcleydruerpe,eeavteedn idf uthreinOgBtUheddidunraottiroenceoivfeththeetest in an inAﬁCnKitaeftleoroappaacskedtetsrcarnisbmeidssiinon[,2it0k].epTthruisnsntirnagt,esgenydpinegrma nitetwedpatockteetsatftdeirfafegrievnent LtiomRe-aoucot pneﬁrgioudr.ations simuTlhtaenbeaosue-ssltyatiinonthceondtiifnfueroeunstlyscliesnteanreiodstuonpdaecrkectosnasniddearnastiwoenr.eIdnwthitihs parLooceRdaWurAe,NevAeCnKif ttoheeaOchBU did not receeiivveedthpeacAkeCt.KFuafrtehrerampoarec,ktehtetrbaanssem-stiastsiioonnw, iatskceopntfriguunrnedintgo, soennlydianngswaenreowurpOacBkUetpaafctkeertsa, given
timed-iosucatrpdeinrgioidn.thTehneebtwasoer-kstsaetrivoenr sciodnetainyuotuhselryploisstseibnledLotoRapWacAkNetrseacenidveadntsrwanesrmedisswioinths ian LorodRear WAN ACKtotoaveoaicdherxetcreaivinetderpfearceknceet.s Fourruthneerxmpeocrteed, tthreanbsamseis-ssitoantsio. nNowteasthcaotnoﬁngluyrtehde tLoooRnalWy AanNswpaecrkoeutsr OBU packteratsn,sdmiistcteadrdfirnogminthtehOe BnUetwwoerrekdseetrevceterdsibdye tahneyboasthe-esrtaptioosnsidbuleriLngoRthaeWtAesNts.rTehceeiveqeudiptrmanenstmloisgssions in ordesrhtoowaevdonido terxatnrsamiinstseiornfesrfernocmesotohreur ndeevxipceecs.ted transmissions. Note that only the LoRaWAN packets transsumbiutArtbesadnaf,froaornemdmrteuhnretaiolO,nwBedhU,ictwhheewrteeersedtsesetwelecectrteeeddcbdareyrpiteehdnedoibnuagtsooenn-sttthahteriieorenadrdcihfufiertreiencntgutrtsahcleecnotaenrsfiitogssu., rTnahatimoenee.lqyInu, iuaprllmbtahenen, t logs showsceednanroiostr, athnesmsaimsseioeqnusipfrmomentoatnhdersodfetwviacreesd. escribed above was used. The OBU was placed on the
As aforementioned, the tests were carried out on three different scenarios, namely, urban,
suburban, and rural, which were selected depending on their architectural conﬁguration. In all
the scenarios, the same equipment and software described above was used. The OBU was placed
on the vehicle, which circulated in selected routes to perform the tests. As we were interested on

Sensors 2018, 18, 772

8 of 19

evaluating a realistic dynamic scenario, the vehicle speed was affected by real trafﬁc conditions. The maximum, minimum, and average speeds, including conﬁdence intervals (α = 0.05), are presented in Table 3. The routes were the same for all the studied LoRaWAN PHY layer settings, so the results can be analyzed in a comparatively way for each considered scenario. The urban one was located in the city of Murcia, Spain, while traveling through its downtown. The base-station was placed on the Faculty of Computer Sciences in the University of Murcia. The base-station placement was at the edge of the rooftop of a ﬁve-story building located in an elevated position and its antenna was pointed towards the test-area by studying its radiation pattern, the distance to the sampling area, and making use of the radiation map obtained from the theoretical coverage study. This process was done trying to optimize the overall reception gain of each experiment, so the antenna remained untouched during the duration of each test. The followed route during the test included the main downtown streets with up to three lanes and high buildings and constructions of up to 15 stories in the surroundings. In turn, the suburban scenario had less adverse conditions for the radio communications, with isolated shorter buildings of up to two stories and some vegetation areas. For this scenario, the base-station placement was at the same point as in the urban one, but the antenna was accordingly pointed to the area of study. The route traveled through industrial and residential areas, with some gentle terrain elevation changes. Finally, the rural scenario was the most favorable as it presented almost free-space conditions. The terrain in which the tests were performed was ﬂat, with lack of large constructions and barely high-vegetation. In this case, the base-station was placed in the rooftop of the Technology Transfer Center in the Fuente Álamo Technology Park, a 4 -story building. The selected route traveled up to 20 km east from the location of the base-station through low transited roads.

Table 3. Vehicle speeds during the sampling tests.

Scenario
Urban Suburban
Rural

Average Speed (km/h) (Conf. Interval, α = 0.05)
22.3 (1.9) 32.6 (2.3) 32.5 (1.5)

Min. Speed (km/h)
0 0 0

Max. Speed (km/h)
53.5 57.2 70.2

As aforementioned, prior to our experimental study, we have examined the expected signal level in the afore-described scenarios by using the well-known Okumura–Hata propagation model. To this end, an accurate radio planning tool including topographic maps and high grade of ﬂexibility that permits introducing the characteristics of the employed equipment has been used [8]. The Okumura-Hata model is an extensively used propagation model for planning wide-area deployments. It covers a wide range of frequencies and types of services, so it is necessary to properly adjust the equipment features such as receivers sensitivity, antennas type, transmission power, carrier frequency, etc. (please, see Table 2).
5. Results and Discussion
In this Section, the outcomes obtained in the different scenarios under study are presented. As explained above, different LoRaWAN PHY layer conﬁgurations have been tested in three environments that are discriminated by their particular conditions against wireless transmissions. This adversity is determined by the number and density of obstacles presented by each of them. Thus, the following scenarios have been considered: (i) urban: high adversity against wireless conditions; (ii) suburban: medium adversity against wireless conditions; and (iii) rural: low adversity against wireless conditions. As stated above, the study has been divided into two well-differentiated stages. First, the theoretical results calculated by a radio planning tool are shown; thereafter, these results are compared by those extracted from the experimental sampling campaign.
5.1. Theoretical Coverage Study
As aforementioned, before performing the experimental study, we used a radio planning tool [8] that permited us to estimate the signal level within the areas covered by the base-station in the

Sensors 2018, 18, x

9 of 20

Sen5so.1rs. 2T0h1e8o, r1e8t,i7c7a2l Coverage Study

9 of 19

As aforementioned, before performing the experimental study, we used a radio planning diftfoeorel n[8t]stcheantaprieorsm. iTtehdisutsootol eemstipmloaytes tthoeposiggrnaaplhliecvmel awpisthininotrhdeearrteoascocnosviedreerdthbye itmhepbaacsteo-fsttahteiotnerirnain eletvhaetidoinffseroenntthsecesniagrnioals.pTrohpisatgoaotlioenmapnlodyps rteospeongtrsahpihgihclmy acpons ﬁinguorradberletoopctoinosnisdetor tphreecimisspealcyt soifmtuhelate thetecrrhaairnaeclteevriasttiiocnssaonndthceonsidgintiaolnpsroopf atghaetiroenalanedqupirpemseenntst.hiTghulys,cobnyficgounraﬁbglue roinpgtiotnhsistotoporlecwisistehlythe
feastiumreuslactoertrheespcohnardaicntgertiostoicusratnedst-cboenddictoionnﬁsgoufrtahteiorne,ail.e.q, uainptmenennats. ’Tghauisn, abnydcohnefiigghutr,irnegcethivisertosoelnwsititivhity,
tratnhsemfeisastuiornespcoowrrers,peotncd. i(nTgabtoleo2u)r, theset-cboevdercaognefigmuaraptsiosnh, oi.we.e, danitnenFnigasu’regsai5n–a7nhdavheigbhete,nreocbetiavienred.
Resceanllstithivatittyh,etrparnospmaigsasitoionnpmowodere,l eatpcp. (lTieadblfeor2)o,btthaeincionvgerthageesemeastpismsahtoiownesdisinthFeigOukruesm5u–r7a-hHavaetabmeeondel.
Obosbetravineetdh.aRt ethcaellgtrheaetnthaereparsopreapgraetisoenntmtohdeelleavpeplslioedf rfeocreoivbteadinpinogwtehresaebeosvteimthateiocnasrdisstehnesOitkivuimtyuarta-the lowHeasttaDmRo, di.eel.., ≈Ob−s1e3rv0edtBhmat[t4h];efogrretehne saarekaesorfecplarersiteyn,twtehehalevveeilnsdoifcarteecdeitvheedlepnogwtheroaf bthoevseetthheeocraertdical masxeinmsiutimvitlyinakt tdhiestlaonwceesst. DInRt,ui.ren.,, ≈th−1e3b0ludeBmare[4a]s; rfeopr rtehseesnatkaeloefvcellaoriftyre, cweeivheadvpeoinwdeircattheadt tihsebleelnogwththe recoefivthere’sseﬂtohoerorseetnicsaitlivmitayx.iTmhuums, loibnskerdvisetathnactesf.orInbotuthrn, ,thteheurbbluane aanredassurbepurrebsaenntscaenleavreiol sotfhreepcelaivnending tooplopwreerditchtaetdisa blienlokwratnhgeeraebceoiuvet r7’skfmlo,orwsheinlesiitnivitthye. rTuhruasl, eonbvsierrovnemtheantt f1o9r kbmothw, athsethuerbmanaxaimndum presduibcuterdbadnisstacenncaer.iToshethsiempillaarnpnrinedgicttoioolnspfroerdtichteedtwao ﬁlinrskt srcaenngaerioasbocuant b7ekemxp, lawinheilde biyn ththeeprruesreanl ce of eonbvstiraocnlems einntb1o9thkmof twhaesmt,hwe hmicahxilmimuimtedprtehdeicmteadxidmisutamncree.aTchheedsirmanilgaer;pinretduircnti,otnhsefcoormthpeletwteoabfisresnt ce otrfasrmodecbieaatsncxitohiaamnercidaluoelsmsrIacoinanrTangtnechbg;oeeeminretumxhtpruaualtralnniissi,nccnteaehdonteitaobucrynoisoumttheappeclelhlpyernmrtreoeesilaatoetcbngehscdiaeeenbsaol.cenfeoobobtyfastbotralbaecsdltmeiatsciaoilnxensiabmlionuItohmtThoecrfoatrnhmuegrmmaelu,tshnwcaiechtnaiiactsihronionloimptteeuictrshemudnaiottlhltloeyedgmrieeasaan.xcohimtaabublmlee by

7 km Figure 5. Theoretical coverage map by considering the Okumura–Hata propagation model. Urban Fisgcuenrear5io. .Theoretical coverage map by considering the Okumura–Hata propagation model. Urban scenario.

Sensors 2018, 18, 772 SSeennssoorrss 22001188,, 1188,, xx

77 kkmm

10 of 19 1100 ooff 2200

FigFsFscuciiegegrnnuueaarr6rere.iioo66T....hTTehhoeeroeotrrieecattiilcccaaollvcceoorvvaeegrreaamggeeampmbaaypp cbboyynccsooidnnessriiiddneegrrtiihnneggOtthhkeeuOOmkkuuuramm–uuHrraaat––aHHpaarottaapappgrraootppioaanggaamttiiooodnnemml. Soouddbeeull..rSSbuuanbbuuscrrbebnaaannrio.
1199 kkmm
FFiigguurree 77.. TThheeoorreettiiccaall ccoovveerraaggee mmaapp bbyy ccoonnssiiddeerriinngg tthhee OOkkuummuurraa––HHaattaa pprrooppaaggaattiioonn mmooddeell.. RRuurraall Fssigcceeunnraaerri7ioo...Theoretical coverage map by considering the Okumura–Hata propagation model. Rural scenario.
5.255...22E..xEEpxxepprieemrriimemneetnnattlaaRll RReseeussluutllsttss AfAAteffrtteeerrveeavvlauallauutaainttiignnggthttheheestssuttuudddieiieedddsssccceeennnaaarrriiiooosssffrroomm aa ttthhheeeooorrreeetttiiicccaaalllpppeeerrrssspppeeecctctiitvvivee,e, ii,nnintthhteehffeoofllolloolwlwoiiwnnggin,,gtthh, eethrreessruuellsttuss lts
obootabbittnaaeiinndeeddiniinnouooruurrerraeelaaislliitssittciiccsassamammppplillniinngggcccaaammmpppaaiiggnn aarree sshhhooowwwnnn...TTThhheeerreerebbbyyy,, ,FFFiiggiguuurreersses88––811–0010ddeedppeiipcctticttthhteehcceoocvvoeevrraaeggreeage ranrraagnneggaeettaaatttitnaaiienndeeddiniinneaeecaahcchhoofoffthtthheeemmmeeennntttiioioonnneeeddd sssccceennaarriiooosss fffooorrrttthhheeetttwwwoooeeexxxttrrteeremmmeeeDDDRRRccoocnnoffniiggﬁuugrruaarttiaiootnniossn,, iis..,ee.i.,,.eDD.,RRD00R0

Sensors 2018, 18, 772 Sensors 2018, 18, x

11 of 19 11 of 20

(SF = 12) and DR5 (SF == 7). IInn tthheessee RRSSSSII heeaatt mapss,, the possiblee different values for CR and packet length ppaarraammeeteterrssaraerenontodtisdtiinsgtiunigsuheisdh;eadd; iascudsisciounssaiboonutabthoeuitmtphaectimofptahcetseofacthtoerssewfailcltboersprwovilildebde plartoevr iodne.dFliarstet,roobns.eFrvirest,hoebnsoetravbelethdeifnfeorteanbcle admiffoenrgentchee ammaoxnimguthme lminakxdimisutamncleins kacdhiisetvaendceisnathcheitehvreede isncetnhaertihosreuensdcernacorinossiduenrdaetirocno.nsideration.

[-93, -102] dBm [-103, -107] dBm [-108, -111] dBm [-112, -117] dBm [-118, -123] dBm Packet lost

(a)
[-93, -102] dBm [-103, -107] dBm [-108, -111] dBm [-112, -117] dBm [-118, -123] dBm Packet lost
(b)
FFiigguurree 88.. RReceecievievdedSiSginganlaSl tSretrnegntghthInIdnidcaictoarto(rRS(RSSI)SIh)eahteamt amp aipn tinhethuerbuanrbsacnensacerinoa.r(iao). D(Ra)0;DaRn0d; (abn)dD(bR)5D. R5.

SensorSSsee2nn0sso1orr8ss,22100811,887,,171828,,xx
[[--9933,,--110022]]ddBBmm [[--110033,,--110077]]ddBBmm [[--110088,,--111111]]ddBBmm [[--111122,,--111177]]ddBBmm [[--111188,,--112233]]ddBBmm PPaacckkeett lloosstt

1122ooff220102 of 19

((aa)) [[--9933,,--110022]]ddBBmm [[--110033,,--110077]]ddBBmm [[--110088,,--111111]]ddBBmm [[--111122,,--111177]]ddBBmm [[--111188,,--112233]]ddBBmm PPaacckkeett lloosstt
((bb)) FigFuFiirggeuu9rre.e9R9..SRRSSSISShIIehhaeetaatmtmmaapappiininnttthhheeesssuuubbbuuurrrbbbaaannnsscscecenenanarraiioroi..o((a.a)()aDD)RRD00;R;aa0nn;dda(n(bbd))D(DbRR)55D.. R5.
[[--9933,,--110022]]ddBBmm [[--110033,,--110077]]ddBBmm [[--110088,,--111111]]ddBBmm [[--111122,,--111177]]ddBBmm [[--111188,,--112233]]ddBBmm PPaacckkeettlloosstt
((aa)) Figure 10. Cont.

Sensors 2018, 18, 772 Sensors 2018, 18, x

13 of 19
13 of 20
[-93, -102] dBm [-103, -107] dBm [-108, -111] dBm [-112, -117] dBm [-118, -123] dBm Packet lost

(b)
Figure 10. RSSI heat map in the rural scenario. (a) DR0; and (b) DR5. Figure 10. RSSI heat map in the rural scenario. (a) DR0; and (b) DR5.
Whereas the maximum reached range is 6.5 km in urban conditions (DR0, Figure 8a), in the rural
Wscehnearreioa,stthheefumrtahxeismt puomintrewaicthecdonrnaencgtievitsy6w.5askmattaininuedrbaatn18c.o5nkdmit(iDonRs0,(FDigRu0r,eF1i0gau)r. eA8sae)x,pienctehde, rural scenairniob,etthweeefunrtthheesset preosiunlttsw, tihthe cmoanxnimecutmivirtyanwgeasreaatcthaeindedinatth1e8s.u5bkumrba(Dn Rsc0e,nFairgiouries 160.7a)k.mAs(DexRp0,ected, in beFtwiguereen9tah).eFsoecuresisnugltosn, ethacehminadxivimiduuaml screannagreio,renaoctehtehde iimn ptahcet osfuebmuprbloayninsgcdeinffaerrieontisDR6.s7oknmthe(DR0, Figurtera9nas)m. iFsosicounsriannggoe.nFeoarcehxaimndpilve,idinutahlesucrebnaanrsioce, nnaortioe,tuhseinigmaplaocwt oDfRe(mDpRl0o)yleinadgsdtoiffaenreinnctreDaRsesoofn the transtamhreeiscslooiovnengrearrganetrgoaefn.1s3Fm2o%irsse(iFoxinagsmurptehla8eta, ivhnsa.tvhFeiegnuuorretb8abbne)e.snNceonttaeakrteihnoa,tauisnsitnvhagilsiadsc,leonawsarDiwoRew(icDtohnRDs0iRd) 5eler(aFtdihgseumtroe a8abns),ilntuhccerkreyease of the cotrvaenrsamgiessoiofn1s3(2p%lea(sFei,goubrseer8vaevths.eFaimguourent8obf).loNstottreanthsmatisisniotnhissusrrcoeunnadriiongwthitehmD).RT5ab(lFeig4uprrees8ebn)t,sthere are lotnhgeecrotmrapnlestme issestioonf sretshualttshraevgearndoint gbethene ltoankgeenstaslinvkaleidst,aabsliswheedcoinnstihdeetrhtrheeemenavsirlouncmkyenttrsanusnmdeisrsions (pleasteu, doybsaenrdvceotnhseidaemrinogutnhteosfixlodsitffterraenst mDRisscoionnfigsuurrartoiuonnsd. iTnhgetohbetmain).edTabbelhea4viporreiss,eanstesxtpheectceodm, tphlaette set of resaulhtsigrheegraDrdRinlgeatdhse tloonsgheosrtelrinckoveestraedblidsihsetadnicnest.hSeotmhreeeirreengvuilraornitmiesenintstuhnisdbeerhsatuvidoyr, aen.gd.,cionnsthideering
the sisxubduirfbfearnenscteDnaRrioco, narﬁegjuursatitfioednsb. yTthhee orbantadionmedpbreesheanvceioorfiso,bastsacelxespeacntdedt,hethiamtpaachtigohf evrehDicRleleads to shomrotebrilictoy.vered distances. Some irregularities in this behavior, e.g., in the suburban scenario, are justiﬁed bRyegthaerdrianngdthoemvaplirdeasteinonceoof tfhoebtshteaocrleetsicaanl sdtutdhye pimrepseanctteodfinvethheicpleremviooubsilSiteyc.tion, observe that
Rtheegdairsdtainngcethcoevveareliddabtyiothneobfatshee-stthaetioornetinicaelacshtuodfythperethsereneteednvinirothnempenretsviuonudserSesctutidoyn,isobhsigehrlvye that the dstishimteainlloacrwetecosottvhedatraeetads-tirbmaytaetthe(dDe Rbbya0s)tehc-elsortsaaedtliiyoonpmilnaantecnhaicnwhgiottohfotlht.hePeatrhctoricevueelreaanrglvyei,rtaohrneeamesxeppnertresismuenenntdetedalrrpsetrsueuvdlityosucissolnhysi.igdPhelleryianssgeimilar to thacot mesptaimreaFtiegdurbey5 tahnedrFaidguiorep8laa,nFniginugret6ooanl.dPFaigrtuirceu9laa,rlayn,dthFeigeuxrepe7rainmdeFnitgaulrree1s0ual.tsInctohnesliidghetrionfg the lowetshtedsaetrae-srualttse, (thDeRc0o)nscilsotseenlcyy mofabtocthh swtuitdhietshseeecmovs etorabgeedeamreoanssptrraetesden, atletdhopurgehvtihoeutshleyo. rPelteicaaslemcaopms pare Figurpersed5iactnads8liag,hFtliyguhrigehse6r atrnadns9ma,isasniodn Fraignugere. sTh7isanmday10bae. mInotihveatleidghbtyosfotmhesdeerveiasutioltnss, tohnetchoenrseiasltency of bostehnsittuivditiyesofsetheemrsecteoivbeersdoermbyonthsetriamtpedac,taolfthsmouagll-hsctahlee othbsetoarceletsictahlatmwaeprse nportedcoinctsiadesrleigdhbtylythheigher
transrmadisiosiopnlanranningget.oTohl.is may be motivated by some deviations on the real sensitivity of the receivers or by the Wimitpharcetgoafrdsmtoaltlh-escianlfeluoebnscetaocfleLsotRhaaWt wAeNrePnHoYt lcaoynesrisdeetrtiendgsbyonththeerasydsitoemplapnernfionrgmatonocel., in
Wadidthitiornegtaordthteo DthRe, tihneﬂuCeRncaendofpLaoylRoaadWAleNngtPhHpYaralamyeetrerssewttienregsalosno tehxeamsiynsetdemduprienrgfotrhmeance, ienxpaedrewcdioxmhnpiteseeiniorndinmtteusren.etnodiTntshogt.hueTbretohceotefDhomreRrpefeoa,s,rrttFaeoh,migetFheuigtoCreuserRers1e.aa1Nt1tn1apoditprneerepsetdhesaeanwynttl,itsotsihnattihdhnoeeraldlleeemenvvrageetxlotlihomoeflfupaPPmbaDDorRrarRaamatnetagettatetthieanoeriefssnde5ewgfdkormearfrpotefhhrreosat,mhtlwhseortehetheeherxasbetvaaueemsdesdiitesenutdlaedimtdsiiceoietdnden.duasTrcrthiiehoninessgartihoes whenfatcuilnitiantegs breostuhlt pcoamrapmareitseorns.byNavooteidtihngatt,hienbioarsdienrtrotoduecleadbobryaetxecethsseisveelygrloanpghstr,awnsemhisasvioensdtehlaimt ited the comnasyidaertriefidciaolulytcinocmreems etnottthhoesleevaetltaoifnpeadckwetitlhosins ian mceartxaiimn uscmenararinogs.ePolefa5sek, mnotferotmhatththeebloansegessttation. This francigleitatcehsierveesdulitnceoamchpsacreinsaorniobbyyaevaochidDinRgctohnefibgiuarsatiinotnroisdpurceesdenbteydeixnceTsasbilvee4l.yFloocnugsitnrganosnmthisesions that mimapyaacrttoiﬁf tchiaelClyRin(Fcirgeumree1n1tat,hc,ee)l,envoetleothf aptabcykeatddloinssgienxtcrearrteadinunscdeannat riniofos.rmPlaetaiosne,innothte LthoaRtatWheAlNongest rangeheaacdheire(vCeRd=in4/8e)a,cahnsoctiecneaabrlieoibmypreoavcehmDenRt ocnonthﬁegluinrkatrieolinabiisliptyreissoebnttaeidneidninTambolest4s.ceFnoacruiossi.nTghiosn the impaicsteosfptehciealClyRn(oFtaigbulerefo1r1tah,ec,cea)s,enooftethtehsautbbuyrbaadndsicnegnaerxiotr(aFirgeudruen1d1ca)n. tOibnsfeorrvminagtitohnis ibnehthaveiLoro,RwaeWAN headcearn(CcoRnc=lu4d/e 8th),atamnaontyicoefatbhlee tirmanpsrmoivsseimonesnwt eorne rtehceeilviendkpraerltiiaablliylictoyrrisupotbedtaainneddthiennmreoctsitfiesdceinnarios. This itsheesrepceeciviaelrlybyntohteabfolerwfoarrdthererocar sceororfectthioens(uFbEuCr)bmanecshcaennisamri.oT(hFuisg,uinreth1i1scc)a.sOe,bthseerevxitnragothveisrhbeeahdavior, we caitnshejcuposantiycfilleoudaddienletehnxagctthhma(nFagingeyuorofeft1ht1hebei,ndtcr,fra)e,naossbmesdeisrlsvinieoktnhrsoatbweuevsretennercseoscnepsirivodevedirdinpegdartbwtiyaoltlshyheocFroEtrpCruapyplrtooeacddedaleunnrdeg.tthhRsee,ngnaarremdcietnilgyﬁed in the re2c0eBivaenrdb4y0tBh,eafpoerrwceaprtdibelerrPoDr Rcoirmrepcrtoivoenm(eFnEtCis) amtteacinheadnwishme.nTehmupsl,oiynintghitshecassheo,rttehset oexnter.aTohivsecrahnead is justiﬁed in exchange of the increased link robustness provided by the FEC procedure. Regarding the
payload length (Figure 11b,d,f), observe that even considering two short payload lengths, namely 20 B
and 40 B, a perceptible PDR improvement is attained when employing the shortest one. This can be an

Sensors 2018, 18, 772

14 of 19

Sensors 2018, 18, x

14 of 20

expected result, as shorter transmissions are less prone to be impacted by the effect of interferences,

collisbioenasn, aenxdpeoctthederrteyspulitc,aal shasrhmorftuerl etrffaencstms iisnshioenrsenatretolewssireplreosnsesytostebme sim. pacted by the effect of

iInntesrofmereentceesst,sc,otlhliesiaotntsa,ianneddovthaelur etyspsieceaml hatormbfeulcoefufencttesriinnhteurietnivteto, ew.gir.e, lienssFsigysutreem1s1. b where the PDR for DR5 aInndsopmayeltoeastds,4t0heBaitstahinigedhevraltuheasnsetheme PtoDbReocboutanitneeridntwuiittihvea, ep.ga.y, lionaFdigsuizree1o1fb2w0 hBe.rTe htheesePDunRusual valuefvosarlcuDaenRs5cbaaenntdbhepeatryhelesouraedlstu4o0ltfBothfisethhreigerhaeleartlrttharfaaﬁnffcitchcecooPnnDddRiittiiooobnntsasienexxepdpeerwireiitnehcneacdepddayudlrouianrdginstihgzeethtoeefs2tts0e, sBlti.ksT,ehltiehkseeesutphneeuesdsupaaetled at whicwh hthicehvtheehivcelheiwcleaswcaisrcciurclautliantigngdudurirninggttrraannssmmiissssiioonnoorrththeeprperseesnecnecoef ospfosrpaodricadobicstoabclsetsabcleetws beeentween the btahsee-bsatsaet-isotnatiaonndanthdethOeBOUB.UH. Howoweveevre,r,nnootetetthhaatt aa cclleeaarrttrreennddisisobosbesrevrevdeidn itnhethatetaaintteadinreedsurltess.ults.

PDR (%)

100% 90% 80% 70% 60% 50% 40% 30% 20% 10%
0%

4/5 4/8 DR0

4/5 4/8 DR1

4/5 4/8 4/5 4/8

DR2

DR3

CR

4/5 4/8 DR4

4/5 4/8 DR5

(a)

PDR (%)

100% 90% 80% 70% 60% 50% 40% 30% 20% 10% 0%

20 40 DR0

20 40 DR1

20 40 20 40

DR2

DR3

Payload length (B)

(b)

20 40 DR4

20 40 DR5

PDR (%)

100% 90% 80% 70% 60% 50% 40% 30% 20% 10%
0%

4/5 4/8 DR0

4/5 4/8 DR1

4/5 4/8 4/5 4/8

DR2

DR3

CR

4/5 4/8 DR4

4/5 4/8 DR5

100% 90% 80% 70% 60% 50% 40% 30% 20% 10%
0%

4/5 4/8 DR0

4/5 4/8 DR1

(c)

4/5 4/8 4/5 4/8

DR2

DR3

CR

4/5 4/8 DR4

4/5 4/8 DR5

(e)

PDR (%)

PDR (%)

100% 90% 80% 70% 60% 50% 40% 30% 20% 10% 0%
100% 90% 80% 70% 60% 50% 40% 30% 20% 10% 0%

20 40 DR0
20 40 DR0

20 40 DR1
20 40 DR1

20 40 20 40

DR2

DR3

Payload length (B)

(d)

20 40 20 40

DR2

DR3

Payload length (B)

(f)

20 40 DR4
20 40 DR4

20 40 DR5
20 40 DR5

PDR (%)

FigurFeig1u1r.eIm11p. aIcmtpoafctthoefCtRheanCdRpaanydlopaadylloenadgtlhenognththoenPDthRe fPoDr Rthefotrhtrheee ethvraeleuaetveadlusacteendarsicoesn.a(raio)sU. rban (a) Urban scenario, impact of CR. (b) Urban scenario, impact of payload length. (c) Suburban scenario.
scenaImriop,acimt opfaCctRo. f(dC)RS;u(bbu)rbUarnbascnenscaerinoa, rimiop, aimctpoafcptaoyflopaadylleonagdthle. n(eg)thR;u(rca)l Sscuebnuarriboa, nimscpeanctaroifoC. RIm. pact of CR(f;)(Rdu)rSaul sbcuenrbaraino, simcepnaacrtioof, pimayploaacdt loefngptahy. load length; (e) Rural scenario, impact of CR; (f) Rural scenario, impact of payload length.
In the light of these outcomes, it could be stated that the best option is always employing a low DInRt,hee.gl.i,gDhRt 0o,fatnhdesheigohuCtcRo,me.egs.,, 4it/8c,ofuolrdenbseusrtinagteldonthgactotnhneecbteivsittyopantidonliniskarlewliaabyisliteym. Hpolowyeivnegr,a low DR, eth.ge.r,eDisRa0n, iamnpdorhtaignht tCraRde, -eo.fgf.r,e4la/t8ed, ftoortheenstiumrein-ogn-laoinr g(TcooAn)noefcetaicvhittyraannsmd iltitnedk prealcikaebtimlitoyt.ivHatoedwever, therebtriysanatsnhmeiimslospiwoonrbtwaitna-rstanttreoastdnaeev-goalifilgfairbbellleea.tiIenndoLtroodRetrahWteotAiilmlNue,st-wroanhte-iacthihris(cTaaoussAseer)ttoihofanet,aTtchahbeltercah4nassnhmnoewiltsteotdchceputpahcaeknoecreyttmiocafolteTivaocaAhted by the lofowr bthite-rdaitfefesraenvtaicloanbflieguinraLtiooRnsaWcoAnsNid,ewrehdicihn coauurseextphearitmtheentcsh. aAnsndeilscoucscsuepdainncy[21o]f, ethaechretsrtarnicstmedission was nduottynceygclleigiinbtlhee. IISnMobradnedrsttoogielltuhsetrrwatiethtthhies laosnsgeLrtoiRoanW, TAaNblTeo4Assheovewreslythliemtihtseboortehtitchael nTuomAbefor r the different conﬁgurations considered in our experiments. As discussed in [21], the restricted duty cycle in the ISM bands together with the long LoRaWAN ToA severely limits both the number of nodes than can simultaneously connect to a single base-station and the number of transmissions per node

Sensors 2018, 18, 772

15 of 19

per day. For that reason, it is highly desirable to keep the ToA as short as possible, hence we argue that,

depenSednsionrsg20o1n8, 1t8h,ex distance of the end-node from the base-station, different DR should be 1e5mofp20loyed

with the aim of balancing transmission reliability and channel occupancy. In order to exemplify this

strateogfyn,oFdiegsutrhean12cadnepsiimctuslttahneeoPuDslRy caottnaniencetdtofoarsienagclhe bDaRse,-sctoantisoindaenridntghethneuemnbde-rnoofdtreandsimstiasnsicoensto the

base-psteartnioondeinpetrhedauyr.bFaonr tehnavt irreoansomne, nitti.sThhigishlsytuddesyiriasbdleotnoekfeoerptthhee mTooAstafsasvhoorratbalsepcoosnsiﬁbgleu, rhaetniocen, i.e.,

CdiRsta=nwbe4xecee/eemas8mrpbgapluenilfoledyoytwhetphdaait3s,wydkslitoetmrhpaae,dttenhagdeosyifaan, i2gFmP0iogDonBuRfr.tebhToae1hfl2dau1nids0scte,0ianp%ongicbcettissrseoatrafnhvttsethemaePitiDneshnseRaiddot-annifttotoraeidrislneitaehnfbdreoioltfimhotnyirgtehaehcnaeeecdbsshsatcasDhDeraR-yRns,tn.tacoeTtoilnhoeosnimcis,dcdplueeirplfaiofandeyngrscettynthho.teeIDanelRonroewdsrddh-enoeusoructdlttdoDeioRn

in of

96% odfistthanecTeotAo tohfeebaacshe-tsrtaatniosmn iinsstihoen,ufrrboamn e2n4v9i9romnms ednot.wTnhitsos1tu0d3ymiss d(polneeasfoer, stehee Tmaobsltef5av).oNraobltee that

the grceoantfeigsutrDatRion(D, iR.e5.,)CwRo=u4l/d8 banedopnalyyloreacdoomf 2m0eBn. dTahbulse, oinbstehrveefuthratthietsist lniontknseocefsasbaroyvteo5emkmplo. yWthiteh this

stratelgowy,etshteDrRelinabdiilsitaynocefsthbelsoywst3emkmc,aans abePDmRaionft1a0in0%edisbayttsaeilneecdtifnogr ltohewhDigRhessitnDaRd.vTehrisseletaradns stmo aission

condirteidouncst.ioAnt othf e96s%amoef ttihme eT, othAeocfhaeancnheltroacncsumpisasniocny, ifsrocmont2r4o9l9lemd sbydomwankitnog1u03semosf h(piglehasDe,Rsseewhen

the trTaanbslme 5is).sNioontectohnadt tihtieognrseaatreestfaDvRo(rDaRbl5e).wOovueldrablel,obnolythreccoonmsmeqeundenabcleesinpethrme fiutrtoheismt lpinrkosvoeftahbeovsyestem scalab5ilkimty. [W21i]th. this strategy, the reliability of the system can be maintained by selecting low DRs in
adverse transmission conditions. At the same time, the channel occupancy is controlled by making

use of higThaDblRes4w. Lhoenngtehset trraanngsem(iksmsio)nacchoinedveitdioinnseaarcehfsacveonraarbiloe.bOy veearcahllD, bRocthoncﬁognuseraqtuioennc. es permit to improve the system scalability [21].

DR

Urban Scenario Suburban Scenario Rural Scenario

Table 4. Longest range (km) achieved in each scenario by each DR configuration.

DR0 DRD1R DDRR2 0 DDRR3 1 DDRR4 2 DDRR5 3
DR4

6.5 Urba5n.4Scenario
4.65.5 4.54.4 44.5 2.48.4
4

6.7 Suburban5.S8cenario
65.7.7 55.8.3 55.7.0 55.3.5 5.0

18.5 Rural S1c3e.n7ario
118.15.6 113.17.5 111.06.3 119.5.6 10.3

DR5

2.8

5.5

9.6

Table 5. Theoretical time-on-air (ms) for the different tested LoRaWAN PHY layer conﬁgurations.

Table 5. Theoretical time-on-air (ms) for the different tested LoRaWAN PHY layer configurations.

DR DR

Payload = 20 Bytes CRPa=y4lo/5a|d C= R20=B4y/t8es
CR = 4/5|CR = 4/8

Payload = 40 Bytes CRPa=yl4o/a5d|=C4R0 B=y4t/e8s
CR = 4/5|CR = 4/8

DDRR00 DDRR11 DDRR22 DDRR33
DDRR44

1811801|02|4294999 98978|71|3183080 45435|36|26525 24274|73|43545
13143|41|81989

2426466|6|33554477 1311351|5|11990055 61661|6|888877 32392|9|447766
18158|5|227711

DDRR55

727|21|01303

10130|3|115522

DR5 DR4 DR3 DR2 DR1 DR0

6 Km≤d≤7 Km

5 Km≤d<6 Km

Distance (Km)

4 Km≤d<5 Km

3 Km≤d<4 Km

2 Km≤d<3 Km

1 Km≤d<2 Km

0

10 20 30 40 50 60 70 80 90 100

PDR (%)

FigurFeig1u2r.eP1D2.RPeDvRoeluvtoilountiownitwhitthhethdeidstisatnacnecefoforreeaacchhDDR in thheeuurrbbaannscsecneanraiori.oC.RC=R4=/84, p/a8y,lpoadyl=oa20dB=. 20 B.

Sensors 2018, 18, 772

16 of 19

Previous works in the related literature has demonstrated that the vehicle motion can negatively impact on the reliability level of LoRaWAN transmissions [19]. For that reason, a nomadic test has also been conducted in the same urban and suburban scenarios in order to verify these observations, compare them with the results obtained under mobility conditions, and quantify the negative effect. A nomadic test consists in conducting a sampling campaign in speciﬁc points, i.e., with the car being stopped instead of doing it in motion. The selected sampling points for this experiment are shown in Figure 13. As in the previous experiment, different DR values have been studied; in this case, the CR was ﬁxed to 4/8 and the payload length to 40 B. For the sake of simplicity and for permitting a direct comparison with the coverage results shown in Figures 8 and 9, we focus on discussing the results attained for the two extreme DRs, i.e., DR0 and DR5. Thus, Figure 14 depicts the attained PDR in the different sampling points for the urban (Figure 14a) and suburban (Figure 14b) scenarios. With the aim of enabling the comparison between both scenarios and to provide information about the separation between the sampling points and the base station, a distance axis has been included also in those ﬁgures. Observe that considering the most conservative DR (DR0), the results were similar to the outcomes obtained under mobility conditions. In the urban scenario (Figure 14a), only the furthest sampling point, P.E, presented an excessive level of packet loss. The rest of sampling points did not seem to be inﬂuenced by the vehicle motion as the results in both tests were similar. The same behavior was observed in the suburban scenario (Figure 14b), with similar maximum link distances in both cases. Note that the sampling point P.7 was in the range limit obtained in the previous test (Figure 9a), which justiﬁes the low level of PDR obtained there, and P.8 was out-of-range in both experiments, so no packets were received in any case. However, the results attained for the highest DR (DR5) slightly differed from one experiment to the other. The nomadic test in the urban scenario (Figure 14a) permitted a longer link range in comparison with the dynamic one (Figure 8b). This was evidenced by observing the sampling points P.C and, especially, P.D, which were out of range in the dynamic test but presented some level of received packets under static conditions. Additionally, in the suburban scenario the results in the sampling points P.5 and P.6 (Figure 14b) also improved those obtained under dynamic conditions (Figure 9b). By analyzing these results, it can be observed that LoRaWAN presents robustness to mobility, and consequently to Doppler effect, when using a low DR, i.e., when employing high values for the SF. However, by making use of higher DRs, end-node mobility emerges as an important element to be considered in order to protect the system reliability. As discussed previously, we face again a trade-off between system robustness and transmission rate, so the mobility characteristics of the scenario under consideration should be added to the afore-discussed environmental conditions when planning and deploying a large-scale LoRaWAN network. Therefore, prior to the network deployment phase, it is necessary to evaluate the terrain and scenario conditions aiming at predicting the power received by the end-nodes. To sum up, it can be concluded that LoRaWAN is a technology that presents reach features for providing long connectivity to IoT deployments in different scenarios with diverse propagation conditions. The election of the different LoRaWAN PHY layer conﬁgurations is determined by the trade-off between the link robustness and the transmission data-rate. Therefore, depending on the wireless link conditions and the end-node mobility, the system should adopt a more or less conservative conﬁguration.

Sensors 2018, 18, 772
Sensors 2018, 18, x
Sensors 2018, 18, x

17 of 19
17 of 20
17 of 20

FiguFrigeu1r3e.1S3.aSmampplilningg ppooiinnttssfofrotrhtehneomnoadmicatdesitc. test.
Figure 13. Sampling points for the nomadic test.

PDR (%)
PDR (%)

100
100 90 90 80

1|km1|km 2|km2|km

3D3|kD|kmRmR00

44D|Dk|kRmRm5 5

5 |k5m|km

6|

km
6|

km7 |km

7 |km8|km

8|km

80 70

70 60

60

50 40

50 30

40 20

30 10

20 0
Sensors 2018, 18, x P.A

P.B

P.C

P.D

P.E

10

(a)

0

DR0 DR5

10P0.A

P1|.kBm 2|kPm.C 3|kmP.D4|km P.5E|km

6| km 7|km

18 of 20
8 |km

90

(a)

80

70

PDR (%)

60

50

40

30

20

10

0 P.1 P.2 P.3 P.4 P.5 P.6 P.7 P.8

(b)

Figure 14. PDR obtained in the nomadic test for the urban and suburban scenarios with DR0 and DR5
Figure 14. PDRfoorbCtRa=in4/e8d, anind ptahyeloandolemngathd=ic40teBsñt(af)oUrrbtahnescuenrabraion. (ba)nSdubsuurbbanusrcbenaanrios.cenarios with DR0 and DR5
for CR = 4/8, and payload length = 40 Bñ (a) Urban scenario; (b) Suburban scenario.
6. Conclusions

In this work, a comprehensive performance evaluation of LoRaWAN in several realistic scenarios has been presented. Different configurations of LoRaWAN PHY layer were explored in order to evaluate the most proper one depending on the propagation conditions. Three typical environments, namely, urban, suburban, and rural have been studied with the aim of considering their adversity to wireless transmissions and, consequently, their impact on the system performance. First, the estimated signal level in these scenarios have been evaluated by means of a precise planning tool, which employs topographic maps and the Okumura-Hata model. Thereafter, the attained

Sensors 2018, 18, 772

18 of 19

6. Conclusions
In this work, a comprehensive performance evaluation of LoRaWAN in several realistic scenarios has been presented. Different conﬁgurations of LoRaWAN PHY layer were explored in order to evaluate the most proper one depending on the propagation conditions. Three typical environments, namely, urban, suburban, and rural have been studied with the aim of considering their adversity to wireless transmissions and, consequently, their impact on the system performance. First, the estimated signal level in these scenarios have been evaluated by means of a precise planning tool, which employs topographic maps and the Okumura-Hata model. Thereafter, the attained outcomes from the theoretical study have been validated by an extensive sampling campaign. In the most adverse scenarios, i.e., urban and suburban, coverage ranges around 6 km were attained; in turn, in the open scenario (rural), a long transmission distance of over 18 km with the lowest data-rate was achieved. From the discussed results, it can be concluded that there is a clear trade-off between link robustness and data-rate (and consequently packet time-on-air); hence, depending on the propagation conditions and the distance between the base-station and the end-node, the LoRaWAN conﬁguration parameters should be accordingly tuned. Particularly, in the urban scenario, for links shorter than 3 km, same levels of PDR were attained for the different DRs under evaluation. Therefore, with the aim of reducing the time-on-air for each packet, it is more convenient to employ high DRs. When the distance between both communication end-points is enlarged, lower DRs allow increasing the link robustness at the expense of dramatically decreasing the transmission rate. Finally, after evaluating the performance of the system under dynamic conditions, the interest was focused on examining the same scenarios but in a static situation to quantify the effect of mobility on performance. For that reason, a nomadic test was also conducted in order compare both scenarios. The results of this experiment conﬁrmed that LoRaWAN presents a notable vulnerability related to the Doppler effect when using high transmission data-rates, but this effect is much less notable in the case of using low DRs. In the light of these results, it can be concluded that LoRaWAN presents a high level of adaptability to be employed in several IoT applications, such as smart cities, ﬂeet/goods tracking, etc. Therefore, by applying the most proper conﬁguration, the transmission system is able to establish long links with high robustness and low power consumption even under mobility conditions. For that reason, as future work, we plan to provide more intelligence to the system, in order to make it capable of auto-adapting the LoRaWAN PHY layer settings to current environmental conditions.
Acknowledgments: This work has been sponsored by the Spanish Ministry of Economy and Competitiveness through the EDISON (contract TIN2014-52099-R), PERSEIDES (contract TIN2017-86885-R), and CHISTERA (contract PCIN-2016-010) projects, and the AEI/FEDER UE project grant TEC2016-76465-C2-1-R (AIM).
Author Contributions: Ramon Sanchez-Iborra conceived and designed the experiments; Jesus Sanchez-Gomez and Juan Ballesta-Viñas performed the experiments; and Maria-Dolores Cano and Antonio F. Skarmeta analyzed the data. All the authors contributed to write the paper.
Conﬂicts of Interest: The authors declare no conﬂict of interest. The founding sponsors had no role in the design of the study; in the collection, analyses, or interpretation of data; in the writing of the manuscript, and in the decision to publish the results.
References
1. Sanchez-Iborra, R.; Cano, M.-D. State of the art in LP-WAN solutions for industrial IoT services. Sensors 2016, 16, 708. [CrossRef] [PubMed]
2. Sanchez-Gomez, J.; Sanchez-Iborra, R.; Skarmeta, A. Experimental comparison of LoRa and FSK as IoT-communication-enabling modulations. In Proceedings of the IEEE Global Communications Conference (Globecom’17), Singapore, 4–8 December 2017; pp. 1–6.
3. Raza, U.; Kulkarni, P.; Sooriyabandara, M. Low Power Wide Area Networks: An Overview. IEEE Commun. Surv. Tutor. 2017, 19, 855–873. [CrossRef]
4. LoRa-Alliance. A Technical Overview of LoRa and LoRaWAN; White Paper; The LoRa Alliance: San Ramon, CA, USA, 2015.

Sensors 2018, 18, 772

19 of 19

5. Sigfox. M2M and IoT Redeﬁned through Cost Effective and Energy Optimized Connectivity; White Paper; Sigfox: Labège, France, 2014.
6. Sanchez-Iborra, R.; Sanchez-Gomez, J.; Santa, J.; Fernandez, P.J.; Skarmeta, A. Integrating LP-WAN communications within the vehicular ecosystem. J. Internet Serv. Inf. Secur. 2017, 7, 45–56.
7. Herrera-Tapia, J.; Hernandez-Orallo, E.; Tomas, A.; Calafate, C.; Cano, J.-C.; Zennaro, M.; Manzoni, P. Evaluating the use of sub-gigahertz wireless technologies to improve message delivery in opportunistic networks. In Proceedings of the 14th IEEE International Conference on Networking, Sensing and Control, (ICNSC 2017), Calabria, Italy, 16–18 May 2017.
8. CloudRF—Online Radio Planning. Available online: https://cloudrf.com/ (accessed on 20 December 2017). 9. Parada, R.; Cárdenes-Tacoronte, D.; Monzo, C.; Melià-Seguí, J. Internet of THings Area Coverage Analyzer
(ITHACA) for complex topographical scenarios. Symmetry 2017, 9, 237. [CrossRef] 10. Georgiou, O.; Raza, U. Low Power Wide Area Network Analysis: Can LoRa Scale? IEEE Wirel. Commun. Lett.
2017, 6, 162–165. [CrossRef] 11. Mikhaylov, K.; Petäjäjärv, J.; Hänninen, T. Analysis of the capacity and scalability of the LoRa wide area
network technology. In Proceedings of the 22th European Wireless Conference, Oulu, Finland, 18–20 May 2016; pp. 1–6. 12. Bankov, D.; Khorov, E.; Lyakhov, A. On the limits of LoRaWAN channel access. In Proceedings of the International Conference on Engineering and Telecommunication (EnT), Moscow, Russia, 29–30 November 2016; pp. 10–14. 13. Naoui, S.; Elhdhili, M.E.; Saidane, L.A. Enhancing the security of the IoT LoraWAN architecture. In Proceedings of the International Conference on Performance Evaluation and Modeling in Wired and Wireless Networks (PEMWN), Paris, France, 22–25 November 2016; pp. 1–7. 14. Weber, P.; Jackle, D.; Rahusen, D.; Sikora, A. IPv6 over LoRaWAN. In Proceedings of the 3rd International Symposium on Wireless Systems within the Conferences on Intelligent Data Acquisition and Advanced Computing Systems (IDAACS-SWS), Offenburg, Germany, 26–27 September 2016; pp. 75–79. 15. Petric, T.; Goessens, M.; Nuaymi, L.; Toutain, L.; Pelov, A. Measurements, performance and analysis of LoRa FABIAN, a real-world implementation of LPWAN. In Proceedings of the IEEE 27th Annual International Symposium on Personal, Indoor, and Mobile Radio Communications (PIMRC), Valencia, Spain, 4–8 September 2016; pp. 1–7. 16. Augustin, A.; Yi, J.; Clausen, T.; Townsley, W.M. A study of LoRa: Long Range & low power networks for the Internet of Things. Sensors 2016, 16, 1466. 17. Haxhibeqiri, J.; Karaagac, A.; Van den Abeele, F.; Joseph, W.; Moerman, I.; Hoebeke, J. LoRa indoor coverage and performance in an industrial environment: Case study. In Proceedings of the 22nd IEEE International Conference on Emerging Technologies and Factory Automation (ETFA), Limassol, Cyprus, 12–15 September 2017; pp. 1–8. 18. Petajajarvi, J.; Mikhaylov, K.; Roivainen, A.; Hanninen, T.; Pettissalo, M. On the coverage of LPWANs: Range evaluation and channel attenuation model for LoRa technology. In Proceedings of the 14th International Conference on ITS Telecommunications (ITST), Copenhagen, Denmark, 2–4 December 2015; pp. 55–59. 19. Petäjäjärvi, J.; Mikhaylov, K.; Pettissalo, M.; Janhunen, J.; Iinatti, J. Performance of a low-power wide-area network based on LoRa technology: Doppler robustness, scalability, and coverage. Int. J. Distrib. Sens. Netw. 2017, 13, 1–16. [CrossRef] 20. Wixted, A.J.; Kinnaird, P.; Larijani, H.; Tait, A.; Ahmadinia, A.; Strachan, N. Evaluation of LoRa and LoRaWAN for wireless sensor networks. In Proceedings of the IEEE Sensors, Orlando, FL, USA, 30 October–3 November 2016; pp. 1–3. 21. Adelantado, F.; Vilajosana, X.; Tuset-Peiro, P.; Martinez, B.; Melia-Segui, J.; Watteyne, T. Understanding the limits of LoRaWAN. IEEE Commun. Mag. 2017, 55, 34–40. [CrossRef]
© 2018 by the authors. Licensee MDPI, Basel, Switzerland. This article is an open access article distributed under the terms and conditions of the Creative Commons Attribution (CC BY) license (http://creativecommons.org/licenses/by/4.0/).

