Ã  lâ€™UniversitÃ© Pierre et Marie Curie, le 5 octobre 2004
M2 Informatique RÃ©seaux

MultimÃ©dia et QualitÃ© de Service

Cours 2 : Le multicast
Timur FRIEDMAN
Ã  partir des transparents de Kim THAI, avec modifications

Copyright 2004 by Timur Friedman

1

Plan
I Introduction I Le multicast au niveau rÃ©seau I Le multicast au niveau transport I Perspectives de recherche
Copyright 2004 by Timur Friedman
2

Plan
I Introduction
I DÃ©finition I Notion de groupe I ProblÃ©matique
I Le multicast au niveau rÃ©seau I Le multicast au niveau transport I Perspectives de recherche
Copyright 2004 by Timur Friedman
3

Quâ€™est-ce que le multicast ?
I moyen efficace de communication 1-vers-N I multicast vs. unicast et broadcast
I unicast : une seule source vers une seule destination I multicast : une seule source vers un sous-ensemble de
destinataires I broadcast : une seule source vers toutes les destinations

unicast (1-ver s-1)

mult icast (1-ver s-N)
Copyright 2004 by Timur Friedman

br oadcast (1-ver s-t ous)

4

Des applications pour le multicast

f iabilit Ã©
100%

t emps r Ã©el int er act if

dist r ibut ion mult imÃ©dia

dist r ibut ion de document s

200 ms

2s

20 s t emps de r Ã©ponse

I confÃ©rence

I flux continus, I distribution de

I dÃ©lai de lâ€™ordre

temps rÃ©el, non logiciels

de 100 ms

interactifs,

I fiabilitÃ© de

I tolÃ©rance dâ€™un

unidirectionnels 100%

certain taux de

I peu de

pertes

contraintes

temporelles
Copyright 2004 by Timur Friedman

5

Pourquoi le multicast ? (1/3)
I distribution utilisant TCP/IP
S

R1

D1

R2

R4

D5

R3

D2

D4

D3
I rÃ©sultats

I plusieurs copies du mÃªme paquet

I plusieurs buffers

Copyright 2004 by Timur Friedman

I plusieurs connexions

6

Pourquoi le multicast ? (2/3)
I distribution utilisant un multicast
S

R1

D1

R2

R4

D5

R3

D2

D4

D3
I rÃ©sultats

I une seule copie de chaque paquet

I un seul buffer

Copyright 2004 by Timur Friedman

I une seule connexion multicast

7

Pourquoi le multicast ? (3/3)
I utilise la bande passante de faÃ§on efficace I prÃ©vient la congestion du rÃ©seau I minimise la charge des serveurs I fournit lâ€™information Ã  davantage dâ€™utilisateurs
simultanÃ©ment I touche un nombre quelconque de personnes en une
seule fois I etc.
Copyright 2004 by Timur Friedman
8

Notion de groupe de multicast
I comment identifier les rÃ©cepteurs dâ€™un paquet Mcast
I en unicast : une adresse IP de destination I ici, toutes les adresses de destination ???
I une abstraction : le groupe de multicast
I associe un ensemble dâ€™Ã©metteurs et de rÃ©cepteurs I existe indÃ©pendamment des Ã©metteurs et rÃ©cepteurs

chaque rÃ©cepteur reÃ§oit les paquets de chaque Ã©metteur

Ã©met t eur s

r Ã©cept eur s

gr oupe de

Copyright 2004 by Timur Friedman

mult icast

9

Adresses de multicast IP (1/2)

I un groupe de multicast : une adresse de classe D

A 0 rÃ©seau

station

B 10 rÃ©seau

station

C 110

rÃ©seau

station

D 1110

adresse multicast

.. .

de 224.0.0.0

11100000 00000000 00000000 00000000
...

Ã  239.255.255.255 11101111 11111111 11111111 11111111

I 224.0.0.0 : non utilisÃ©e I 224.0.0.1 : reprÃ©sente lâ€™ens. des stations du sous-rÃ©seau considÃ©rÃ© I il nâ€™y a pas dâ€™adresse pour lâ€™ens. des machines de lâ€™Internet
Copyright 2004 by Timur Friedman
10

Adresses de multicast IP (2/2)

I adressage du groupe

HQWrWH ,3
S

S

@ IP source 224.1.2.3

donnÃ©es Ã  Mcaster

DGUHVVH GH GHVWLQDWLRQ

D

D

D

D

les r Ã©cept eur s sâ€™abonnent

D

Ã  lâ€™adr esse de gr oupe 224.1.2.3

I indirection dâ€™adresse
I chaque hÃ´te a sa propre @IP, indÃ©pendante de lâ€™@groupe
- dissociation des problÃ¨mes
I dÃ©couvrir lâ€™ensemble des groupes Mcast courants I exprimer le souhait de recevoir les paquets dâ€™un groupe I dÃ©couvrir lâ€™ens. des rÃ©cepteurs dâ€™un groupe I dÃ©livrer les donnÃ©es Ã  chaque membre Copyright 2004 by Timur Friedman du groupe
11

Multicast : les problÃ¨mes
I des questions...
I quand et comment un groupe naÃ®t-il et prend-il fin ? I quand et comment lâ€™@ groupe est-elle choisie ? I comment de nouvelles stations se joignent-elles Ã  un groupe ? I y-a-t-il des conditions pour lâ€™appartenance Ã  un groupe ? I comment les routeurs interopÃ¨rent-ils pour dÃ©livrer les paquets ?
I des choix...
I un rÃ©cepteur doit pouvoir joindre ou quitter un groupe en cours de transmission
I un rÃ©cepteur doit pouvoir joindre ou quitter un groupe sans le signaler explicitement aux Ã©metteurs
I des constats....
I les hÃ´tes rÃ©cepteurs sont souvent connectÃ©s Ã  des rÃ©seaux locaux...
Copyright 2004 by Timur Friedman
12

Plan
I Introduction I Le multicast au niveau rÃ©seau
I Le multicast sur un LAN I Le protocole IGMP I Le modÃ¨le de service I Les algorithmes de routage multicast I Les protocoles de routage multicast
I Le multicast au niveau transport I Perspectives de recherche
Copyright 2004 by Timur Friedman
13

Multicast sur un LAN (1/3)
I lâ€™existant (cas dâ€™Ethernet)
I Ethernet repose sur un support Ã  diffusion I chaque station a une carte rÃ©seau avec une @ matÃ©rielle
spÃ©cifique I il existe une adresse de diffusion (FF:FF:FF:FF:FF:FF)
I que faire si lâ€™on souhaite joindre uniquement un sousensemble de stations ?
I ex : H1 souhaite envoyer un paquet Mcast Ã  H2 et H4 qui sont sur le mÃªme rÃ©seau que lui
I deux possibilitÃ©s...
Copyright 2004 by Timur Friedman
14

Multicast sur un LAN (2/3)
I le multic#aVUsFt de rÃ©seau#GuVWtilise le broadcast de liaison
@ de H1 FF.FF.FF.FF.FF.FF paquet IP multicast

H1 IP

H2 IP

H3 IP

H4

IP

...

Et her net

Et her net

Et her net

Et her net

I le multicast de rÃ©seau utilise le multicast de liaison
@ de H1 @ MAC multicast paquet IP multicast

H1 IP

H2 IP

H3 IP

H4

IP

...

Et her net

Et her net

Et her net

Et her net

Copyright 2004 by Timur Friedman
15

.. .

Multicast sur un LAN (3/3)
I traduction des adresses IP multicast en @ Ethernet
I format des adresses multicast Ethernet
de 01:00:5e:00:00:00
0000 0001 0000 0000 0101 1110 0000 0000 0000 0000 0000 0000
Ã  01:00:5e:7f:ff:ff
0000 0001 0000 0000 0101 1110 0111 1111 1111 1111 1111 1111
I mÃ©canisme de traduction
1110 xxxx x
 GHUQLHUV ELWV
0000 0001 0000 0000 0101 1110 0
Â¯ on sait Mcaster un paquet IP sur un LAN Ã  diffusion !
Copyright 2004 by Timur Friedman
16

IGMP : Quâ€™est-ce que câ€™est ?

I comment un routeur dÃ©termine-t-il si son LAN possÃ¨de des rÃ©cepteurs pour un groupe donnÃ© ?

I Internet Group Management Protocol
I permet Ã  un hÃ´te dâ€™indiquer Ã  son routeur local quâ€™il souhaite joindre un groupe
I est utilisÃ© sur les LAN Ã  diffusion H ... H

H I GMP

R

I GMP

I GMP H

... ...

R H

r out age mult icast gr ande dist ance

H R
I GMP

Copyright 2004 by Timur Friedman
17

IGMP Version 1 (1/1)

I RFC 1112 (Aug.89)

I Ã©change de messages query/report

S2 S1

en-tÃªte IP @ IP source 224.9.9.9 donnÃ©es
@ destination

H H

r out age mult icast gr ande dist ance
R H

H
TXHU\ TXHOTXÂ¶XQ LQWpUHVVp SDU XQ JURXSH"

UHSRUW  H

H

H UHSRUW 

Copyright 2004 by Timur Friedman
18

IGMP Version 1 (2/2)
I risque de congestion
I Ã©talement des rÃ©ponses basÃ© sur des temporisateurs
R c envoi de la r equÃªt e
query

H

H

d ar mement du t empo f r Ã©cept ion de la r Ã©ponse,
dÃ©sar mement du t empo

report
H
d ar mement du t empo e envoi de la r Ã©ponse

- rÃ©duction du trafic sur le LAN si aucun membre / dÃ©lai Ã©ventuel (qq s.) avant de recevoir les donnÃ©es
Copyright 2004 by Timur Friedman
19

IGMP Version 2 (1/2)

I RFC 2236 (Nov.97)

I un rÃ©cepteur informe explicitement son routeur lorsquâ€™il quitte un groupe
I 3 types de message

type de message

envoyÃ© par but

membership_query

gÃ©nÃ©ral

routeur sâ€™enquÃ©rir des groupes auxquels sont abonnÃ©s les hÃ´tes

spÃ©cifique routeur demander si un groupe donnÃ© a des membres sur le LAN

membership_report hÃ´te

indiquer que lâ€™hÃ´te souhaite joindre ou a joint un groupe

leave_group

hÃ´te

indiquer que lâ€™hÃ´te quitte un groupe donnÃ©

I Ã©talement des rÃ©ponses avec 0 Â” tempo Â” MaxRespTime

Copyright 2004 by Timur Friedman
20

IGMP Version 2 (2/2)
en-tÃªte IP

S2 S1

@ IP source 224.9.9.9 donnÃ©es @ destination

H

r out age mult icast

H

gr ande dist ance

H H

R

TXHU\

TXHOTXÂ¶XQ LQWpUHVVp SDU XQ JURXSH"

OHDYHBJURXS  H

H

H UHSRUW 

I format du message

type MaxRespTime

Checksum

Multicast Group Address

rÃ©duction de la latence du /HDYH Copyright 2004 by Timur Friedman 21

IGMP Version 3

I GUDIW en cours

I un rÃ©cepteur peut sÃ©lectionner les sources quâ€™il souhaite

(ne pas) entendre

en-tÃªte IP

S3

S2

@ IP source 224.9.9.9 donnÃ©es

S1

@ destination

H

r out age mult icast

H

gr ande dist ance

H H

R

TXHU\ TXHOTXÂ¶XQ LQWpUHVVp SDU XQ JURXSH"

UHSRUW 

H

VRXUFHâ‰ 6

H

H

UHSRUW 

VRXUFH 6

Copyright 2004 by Timur Friedman
22

Le modÃ¨le de service du multicast (1/5)
I issu des travaux de Steve Deering I caractÃ©ristiques de la transmission
I multicast IP : transmission dâ€™un paquet IP Ã  un groupe dâ€™hÃ´tes identifiÃ© par une seule adresse de destination
I transmission EHVW HIIRUW
I caractÃ©ristiques du groupe
I appartenance dynamique I pas de restriction quant Ã  la localisation et au # de membres I un hÃ´te peut Ãªtre simultanÃ©ment membre de plusieurs groupes I un hÃ´te nâ€™a pas besoin de faire partie dâ€™un groupe pour Ãªtre source I groupe permanent/transitoire I lâ€™opÃ©ration de -RLQ est UHFHLYHUGULYHQ
Copyright 2004 by Timur Friedman
23

Le modÃ¨le de service de multicast (2/5)
/ lâ€™Ã©metteur ne contrÃ´le pas qui joint le groupe / il nâ€™y a pas de contrÃ´le sur qui envoie au groupe / les paquets issus de plusieurs sources peuvent Ãªtre reÃ§us entrelacÃ©s / 2 groupes diffÃ©rents peuvent choisir la mÃªme @
I rÃ´le des routeurs Mcast locaux
I co-rÃ©sidents ou sÃ©parÃ©s des routeurs classiques I un routeur local qui reÃ§oit un paquet Mcast dâ€™un de ses hÃ´tes, avec un
TTL>1, le fait suivre vers tous les sous-rÃ©seaux connectant des membres rÃ©cepteurs I sur les sous-rÃ©seaux destinataires, le routeur local termine la transmission en Mcastant le paquet en local
Copyright 2004 by Timur Friedman
24

Le modÃ¨le de service de multicast (3/5)

I le RFC 1112 spÃ©cifie les extensions Ã  apporter Ã  un hÃ´te IP pour supporter le Mcast
I 3 niveaux de conformitÃ©
I 0 : lâ€™hÃ´te ne supporte pas le Mcast I 1 : lâ€™hÃ´te peut Ã©mettre Ã  destination dâ€™un groupe I 2 : lâ€™hÃ´te supporte le Mcast en Ã©mission et rÃ©ception
I modÃ¨le dâ€™implÃ©mentation IP dâ€™un hÃ´te

modules de protocoles de niveau sup.

LQWHUIDFH GH VHUYLFH ,3

PRGXOH ,3

,&03 ,*03

LQWHUIDFH GH VHUYLFH /$1

PRGXOH /$1
(Ethernet)

WUDGXFWLRQ GÂ¶#
(ARP)
Copyright 2004 by Timur Friedman

25

Le modÃ¨le de service de multicast (4/5)
I les extensions pour lâ€™envoi Mcast
I interface de service IP
I utilisation de SendIP I @ dest = @ de groupe I le niveau supÃ©rieur doit pouvoir spÃ©cifier un TTL
I module IP
I si IP-dest est sur le mÃªme rÃ©seau local RX VL ,3GHVW HVW XQH # GH JURXSH alors envoyer le paquet en local Ã  IP-dest sinon envoyer le paquet en local Ã  GatewayTo (IP-dest)
I interface de service LAN I module LAN
I mÃ©canisme de traduction des @IP Mcast en @MAC Mcast
Copyright 2004 by Timur Friedman
26

Le modÃ¨le de service du multicast (5/5)
I les extensions pour la rÃ©ception Mcast
I interface de service IP
I utilisation de ReceiveIP I ajout de JoinHostGroup (group-address, interface) I ajout de LeaveHostGroup (group-address, interface)
I module IP
I maintien de la liste des groupes dont lâ€™hÃ´te est membre pour chacune des interfaces (mise Ã  jour avec les Join et Leave)
I intÃ©gration de IGMP et adhÃ©sion Ã  224.0.0.1
I interface de service LAN
I ajout de JoinLocalGroup (group-address) I ajout de LeaveLocalGroup (group-address)
I module LAN
I mÃ©canismes de filtrage par la carte souhaitÃ©s
Copyright 2004 by Timur Friedman
27

Plan
I Introduction I Le multicast au niveau rÃ©seau
I Le multicast sur un LAN I Le protocole IGMP I Le modÃ¨le de service I Les algorithmes de routage multicast
I Shortest Path Tree I Minimum Cost Tree I Constrained Tree
I Les protocoles de routage multicast
I Le multicast au niveau transport I Perspectives de recherche
Copyright 2004 by Timur Friedman
28

Les algorithmes de routage multicast
I objectif : calculer un arbre de liens connectant tous les routeurs ayant des hÃ´tes appartenant au groupe
I buts :
I minimiser la distance entre la source et chaque rÃ©cepteur I minimiser lâ€™utilisation de liens dans le rÃ©seau ' ces buts ne sont pas compatibles
Copyright 2004 by Timur Friedman
29

Les algorithmes SPT (1/2)
I but : calculer un arbre
I ayant la source S pour racine I couvrant tous les rÃ©cepteurs Di du groupe I tel que la distance entre S et Di soit minimum
I algorithmes de base
I Bellmann-Ford : Ã  vecteurs de distance I Dijkstra : Ã  Ã©tats des liens
/ un arbre par Ã©metteur
Copyright 2004 by Timur Friedman
30

Les algorithmes SPT (2/2)

S

S

R1

R1

R3 D2

R3 D2 3

D1 R2 R5 D3 R4

3 D1

R2

R5

D3 4 R4

R6 D4 R7

R6 D4 4 R7

R8

D5 R9

R10 D6

R8 5 D5 R9

R10 D6 5

R11 D7

R11 D7 5

un exemple de t opologie

lâ€™ar br e obt enu avec un algor it hme Ã  vect eur s de dist ance

D = 29, li ens : 17 Copyright 2004 by Timur Friedman
ii

31

Les algorithmes MCT (1/2)
I but : minimiser le coÃ»t total de lâ€™arbre I 2 familles
I les algorithmes Minimum Spanning Tree
I contrainte : lâ€™arbre ne doit toucher aucun nÅ“ud qui ne soit pas membre du groupe (pas rÃ©aliste car les routeurs ne sont pas de membres)
I ex : algorithme de Prim
I les algorithmes Minimum Steiner Tree
I la contrainte est levÃ©e / problÃ¨me NP-complet / ils supposent de connaÃ®tre toutes les liaisons du rÃ©seau / ils sont monolithiques / ils nâ€™exploitent pas les informations dÃ©jÃ  disponibles de routage unicast
Copyright 2004 by Timur Friedman
32

Les algorithmes MCT (2/2)

S

S

R1

R1

R3 D2 D1 R2 R5 D3 R4

R3 D2 3

5 D1

R2

R5

D3 4

R6 D4 R7

R6 D4 5

R8

D5 R9

R10 D6

6 D5 R9

R10 D6 7

R11 D7

R11 D7 7

lâ€™ar br e obt enu avec un algor it hme Ã  vect eur s de dist ance
r q : dist (S, D6) = 5

lâ€™ar br e de St einer r q : dist (S, D6) = 7

D = 37, li ens : 15 Copyright 2004 by Timur Friedman
ii

33

Les algorithmes CT
I but : minimiser simultanÃ©ment la dist(S, Di) et le coÃ»t total de lâ€™arbre
I principe
I associer Ã  chaque lien 2 mÃ©triques (distance/dÃ©lai et coÃ»t) I rechercher lâ€™arbre Ã  coÃ»t minimum tel que dist(S, Di) Â”
Copyright 2004 by Timur Friedman
34

Quâ€™appelle-t-on IP multicast ?
I mÃ©canisme utilisÃ© dans lâ€™Internet pour construire un arbre de routage multicast HIILFDFH et VDQV ERXFOHV
I IGMP + protocole de routage Mcast
Copyright 2004 by Timur Friedman
35

RPF (1/2)
I Reverse Path Forwarding (Source-based Routing)
I lâ€™une des premiÃ¨res techniques utilisÃ©es
I but : construire un arbre ayant S comme racine et minimisant dist(S, Di)
I principe : utiliser lâ€™inondation (IORRGLQJ) avec
I si un paquet est reÃ§u par lâ€™if utilisÃ©e par le routeur pour joindre S alors le paquet est retransmis sur les autres if sinon le paquet est rejetÃ©
- mÃ©canisme simple
I les informations utilisÃ©es sont celles du routage unicast I Ri nâ€™a pas Ã  connaÃ®tre les arbres recouvrants I pas de mÃ©canisme particulier pour arrÃªter lâ€™inondation
Copyright 2004 by Timur Friedman
36

RPF (2/2)

H1 F R1 F

F H2

F

R3

H4 F

H3

H5

R2

F

F F

F H6

R4

F H9 F
R6

F

H7

F H8

H10 F

F

H11 F

R7 F

H16 F

R12 H17

F

F

R5

F

F

F H14

R8

F

H15

F

F F H12
R9 H13
F

R13

R11

R10

F

F

F

H18 H19 H20

H21 H22 H23

H24 H25 H26

Copyright 2004 by Timur Friedman

37

Truncated Broadcasting (1/2)
I but : rÃ©duire le trafic sur les LAN feuilles I idÃ©e : utiliser les informations dâ€™appartenance fournies
par IGMP pour dÃ©terminer sâ€™il faut ou non Mcaster un paquet sur un LAN feuille
I forme dâ€™Ã©lagage (SUXQLQJ) des feuilles I pas de rÃ©duction de trafic au cÅ“ur du rÃ©seau
Copyright 2004 by Timur Friedman
38

Truncated Broadcasting (2/2)

H1 F R1 F

H2

F

R3

H4 F

H3

H5

R2

F

F F

H6

R4

F

F

H7

H9

R6

H8

H10

F

R5

R7

F

F

F

H11

H12

F F

H14

R9

H16

R8

F

H13

R12

H15

H17

F

F

F

F

R13

R11

R10

F

F

H18 H19 H20

H21 H22 H23

H24 H25 H26

Copyright 2004 by Timur Friedman

39

DVMRP (1/6)
I RFC 1075 (Nov.88), draft Version 3 en cours I 'LVWDQFH 9HFWRU Multicast Routing Protocol I but : rÃ©duire le trafic au cÅ“ur du rÃ©seau I principe : inondation et Ã©lagage (IORRGLQJ DQG SUXQLQJ)
I sâ€™il nâ€™a pas de membre sur son LAN, un routeur feuille envoie un message prune Ã  ses voisins
I un routeur feuille peut envoyer un prune sur toutes ses if, sauf celle correspondant Ã  son SP avec la source (i.e. lâ€™if RPF)
I quand un routeur intermÃ©diaire reÃ§oit un prune sur chacune de ses if, sauf lâ€™if RPF, il remonte le prune en amont
I quand un routeur envoie un prune, il mÃ©morise la paire (Source, Groupe) pour laquelle le prune a Ã©tÃ© envoyÃ©
Copyright 2004 by Timur Friedman
40

DVMRP (2/6)

H1 F R1 F

H2

F

R3

H4 F

P

H3

R2

F

FF

H5

P

P R4

F

F P

H9 R6

P H8

I nondat ion et Ã©lagage
H6 H7

H10

F

R5

R7

PF

F P

F

H11 F
F

P

H12

H14

R9

H16 P
R12

R8

F

H13

H15

H17

F

F

P

F

P

P

P

R13

R11

R10

F

F

H18 H19 H20

H21 H22 H23

H24 H25 H26

Copyright 2004 by Timur Friedman

41

DVMRP (3/6)

H1 D R1

H2

D

R3

H4 D

H3

Lâ€™ar br e apr Ã¨s Ã©lagage

R2 H5

H6 R4

D

H7

H9

R6

H8

H10

R5

R7

D

H11

H12

H14

R9

H16

R8

H13

R12 H17

H15 D

D

R13

R11

R10

D

D

H18 H19 H20

H21 H22 H23

H24 H25 H26

Copyright 2004 by Timur Friedman

42

DVMRP (4/6)

H1 F R1

H2

F

R3

H4 F

H3

Gr ef f e

R2 H5

H6 R4

F G
H9 R6

H7 H8

H10

R5

R7

F

H11

G H12

H14

R9

H16

R8

H13

R12 H17

H15 F

F

R13

R11

R10

F

F

H18 H19 H20

H21 H22 H23

H24 H25 H26

Copyright 2004 by Timur Friedman

43

DVMRP (5/6)

H1 D R1

H2

D

R3

H4 D

H3

Lâ€™ar br e apr Ã¨s la gr ef f e

R2 H5

H6 R4

D

H7

H9

R6

D

H8

H10

R5

R7

D

H11

D D H12

H14

R9

H16

R8

H13

R12 H17

H15 D

D

R13

R11

R10

D

D

H18 H19 H20

H21 H22 H23

H24 H25 H26

Copyright 2004 by Timur Friedman

44

DVMRP (6/6)
/ problÃ¨mes communs aux protocoles Ã  vecteurs de distance (e.g. temps de convergence)
/ processus pÃ©riodique dâ€™inondation et dâ€™Ã©lagage pour chaque source
/ mÃ©morisation des enregistrements prune (Source, Groupe)
Copyright 2004 by Timur Friedman
45

MOSPF
I RFC 1584 (March 94) I Multicast Open Shortest Path First I principe
I opÃ¨re dans un AS qui utilise OSPF pour lâ€™unicast I Ã©tend OSPF en ajoutant les informations dâ€™appartenance
aux informations dâ€™Ã©tats des liens qui sont diffusÃ©es par OSPF
/ problÃ¨me : VFDODELOLW\ avec la taille du rÃ©seau
I mÃ©morisation dâ€™un enregistrement par groupe et par lien du rÃ©seau
I un arbre par source
Copyright 2004 by Timur Friedman
46

CBT (1/3)
I RFC 2189 et 2201 (Sept.97) I Core Based Tree (Group-shared Tree) I but : Ã©viter les inconvÃ©nients de DVMRP et MOSPF
I rÃ©sistance au facteur dâ€™Ã©chelle : un seul arbre pour le groupe I efficacitÃ© (Ã©viter les inondations) : messages de Join et de
Leave explicites
I principe : construire un arbre partagÃ©, bidirectionnel, avec un cÅ“ur unique
Copyright 2004 by Timur Friedman
47

CBT (2/3)
I construction de lâ€™arbre
I un routeur local qui a un nouveau membre pour un groupe envoie un message join-request vers le cÅ“ur en unicast
I le cÅ“ur ou le premier routeur sur le chemin faisant dÃ©jÃ  partie de lâ€™arbre rÃ©pond par un join-ack
I chaque routeur ayant vu passer le join-request marque lâ€™if sur laquelle il lâ€™a reÃ§u
I maintien de lâ€™arbre
I chaque routeur envoie pÃ©riodiquement des echo-request Ã  son routeur amont
I le routeur amont rÃ©pond par des echo-reply I si un routeur aval nâ€™obtient pas de rÃ©ponse au bout de N essais, il
dÃ©tache son sous-arbre en envoyant un flush-tree
Copyright 2004 by Timur Friedman
48

CBT (3/3)

| R4

~S

R1

R2

R3

cÅ“ ur

x y} z

{

- avantages
I pas dâ€™inondation (vs. DVMRP)

x R1 envoie un join (G) au cÅ“ ur y R2 mar que lâ€™if R2-R1 pour f air e
suivr e ult Ã©r ieur ement les paquet s
z R3 mar que lâ€™if R3-R2 { le cÅ“ ur mar que lâ€™if cÅ“ ur -R3 | lor sque R4 r ej oint G, son join
sâ€™ar r Ãªt e Ã  R2
} R2 mar que lâ€™if R2-R4 ~ pour envoyer un paquet Ã  G, S lâ€™envoie
en unicast au cÅ“ ur qui f ait suivr e

I un hÃ´te peut joindre/quitter un groupe sans dÃ©lai (vs. DVMRP)

I un enregistrement par groupe avec les if sortantes (vs. DVMRP)

I pas de calcul explicite dâ€™arbre (vs. MOSPF)

/ inconvÃ©nients

I problÃ¨mes de fiabilitÃ©, robustesse et de congestion pour le cÅ“ ur
I lâ€™arbre nâ€™est pas optimal pour toutes les sources
Copyright 2004 by Timur Friedman

49

PIM (1/3)
I RFC 2362 (June 98) I Protocol Independent Multicast I idÃ©e : distinction explicite de 2 scÃ©narios de distribution I le mode dense
I les membres sont gÃ©ographiquement concentrÃ©s dans une zone
I idÃ©e : RPF avec IORRGDQGSUXQH, similaire Ã  DVMRP est alors raisonnable
Copyright 2004 by Timur Friedman
50

PIM (2/3)

I le mode Ã©pars

I les membres sont gÃ©ographiquement Ã©parpillÃ©s

I but : un routeur ne doit pas avoir Ã  travailler, Ã  moins de rejoindre un arbre

I principe : approche FHQWHUEDVHG, similaire Ã  CBT

I sauf :

I pas dâ€™acquittement en rÃ©ponse au join

I le join est envoyÃ© pÃ©riodiquement pour Â«rafraÃ®chirÂ» lâ€™arbre

I le point de RDV informe une source active dâ€™arrÃªter dâ€™Ã©mettre lorquâ€™il nâ€™y a plus de routeurs dans lâ€™arbre

I changement de mode possible : de lâ€™arbre partagÃ© vers lâ€™arbre par source

I les points de RDV Ã©mettent pÃ©riodiquement en aval pour indiquer leur

activitÃ©

Copyright 2004 by Timur Friedman

51

PIM (3/3)

S

R4

R3 chemin

avec PI M

â€¢ R1 sait que son SP avec S passe par son if R1-R4 â€¢ or , R1 r eÃ§oit les paquet s Mcast sur son if R1-R2 â€¢ R1 envoie un join Ã  R4 â€¢ R1 envoie ensuit e un prune au cÅ“ ur

D

R1

R2

cÅ“ ur

â€¢ le cÅ“ ur ar r Ãªt e le t r ansf er t Mcast sur cÅ“ ur -R2

et R2-R1

chemin avec CBT

- le changement de mode per met de dÃ©char ger le cÅ“ ur

- en cas de panne du cÅ“ ur , les hÃ´t es ayant commut Ã© de mode cont inuent de r ecevoir

/ PI M ne dit pas comment un r out eur dÃ©t er mine le point de RDV dâ€™un gr oupe

/ PI M ne dit pas comment dÃ©t er miner si un gr oupe est dense ou Ã©par s

Copyright 2004 by Timur Friedman
52

Le Mbone (1/3)
I problÃ¨me
I pour mettre en Å“ uvre le Mcast sur lâ€™Internet, il faut que tous les routeurs aient des fonctions de Mcast et que les routeurs locaux supportent IGMP
I la plupart des routeurs de lâ€™Internet ne supportent pas le Mcast !!!
I idÃ©e
I bÃ¢tir des sous-rÃ©seaux capables de Mcast Ã  la pÃ©riphÃ©rie de lâ€™Internet I les interconnecter par des WXQQHOV, les extrÃ©mitÃ©s des tunnels sont des
stations avec mrouted et un support de lâ€™OS pour le Mcast
I Multicast Backbone of the Internet
I rÃ©seau virtuel de recouvrement, solution transitoire I premier tunnel en 88 entre BBN et Stanford I des milliers de sous-rÃ©seaux aujourdâ€™hui I utilisÃ© pour diffuser des sessions IETF ou des conf. IEEE/ACM
Copyright 2004 by Timur Friedman
53

Le Mbone (2/3)

I principe : le WXQQHOLQJ

I encapsulation des paquets Mcast transmis sur le Mbone dans des paquets IP classiques

I lâ€™extrÃ©mitÃ© du tunnel rÃ©ceptrice dÃ©tecte quâ€™elle a un paquet IP encapsulÃ© dans un paquet IP (protocol =4)

I aprÃ¨s dÃ©sencapsulation, elle fait suivre le paquet Mcast

I soit en local sur son sous-rÃ©seau, sâ€™il a des hÃ´tes membres

I soit au prochain routeur Mcast, aprÃ¨s rÃ©-encapsulation

HQWrWH ,3 XQLFDVW

OH SDTXHW 0FDVW GÂ¶RULJLQH

@ M1

@ M2

@ M1 224.5.5.5 donnÃ©es

unicast unicast unicast

encapsulat ion M1

t unnel

dÃ©sencapsulat ion M2

R1

R2

Copyright 2004 by Timur Friedman
chemin r Ã©el
54

Le Mbone (3/3)
I trafic
I les confÃ©rences gÃ©nÃ¨rent typiquement 100-300 kbits/s (limitÃ© Ã  500 kbit/s) I pas de mÃ©canisme de Â«policeÂ» mais une dÃ©ontologie de lâ€™utilisateur
I applications
I annuaires de session (sd, sdr) I confÃ©rences audio (vat, nevot, rat) I confÃ©rences vidÃ©o (nv, ivs, vic, nevit) I tableau blanc (wb) I Ã©diteur de textes (nte) I jeux distribuÃ©s interactifs (MiMaze)
Copyright 2004 by Timur Friedman
55

Plan
I Introduction I Le multicast au niveau rÃ©seau I Le multicast au niveau transport
I fiabilitÃ© I SRM I RMTP
I Perspectives de recherche
Copyright 2004 by Timur Friedman
56

FiabilitÃ©
I peut-on Ã©tendre lâ€™approche utilisÃ©e en unicast (ACK) ?
I chaque destination doit envoyer un ACK pour chaque (groupe de) message(s)
I un msg est retransmis jusquâ€™Ã  rÃ©ception dâ€™un acquittement de chaque destinataire
/ congestion du rÃ©seau / implosion de la source
I idÃ©e : utiliser des NAK
I le contrÃ´le est dÃ©placÃ© de lâ€™Ã©metteur vers les rÃ©cepteurs I la source Ã©met sans se prÃ©occuper des ACK I les rÃ©cepteurs dÃ©tectent les pertes sur Â«trousÂ» de NÂ°de sÃ©quence
I de nombreux protocoles ont Ã©tÃ© proposÃ©s
I atomicitÃ© : soit 0 soit tous les rÃ©cepteurs ont reÃ§u le msg I terminaison : le rÃ©sultat dâ€™une transm. est connu en un temps fini
Copyright 2004 by Timur Friedman
I SRM, RMTP, RAMP, RMP, etc. 57

SRM (1/2)
I Scalable Reliable Multicast
I offre une transmission fiable, sans sÃ©quencement, Â«VFDODEOHÂ» (car UHFHLYHU EDVHG + reprise en local)
I 2 composants I un composant LQGpSHQGDQW GH OÂ¶DSSOLFDWLRQ : offre les mÃ©canismes pour demander et rÃ©cupÃ©rer les segments de donnÃ©es manquants I un composant GpSHQGDQW GH OÂ¶DSSOLFDWLRQ : est responsable du nommage des segments de faÃ§on Ã  ce quâ€™ils soient identifiÃ©s de maniÃ¨re unique par tout le groupe et de lâ€™ordonnancement
I idÃ©e : un segment manquant nâ€™est pas forcÃ©ment retransmis par la source
I sur dÃ©tection dâ€™une perte, la demande de retransm. est McastÃ©e I le rÃ©cepteur le plus proche du demandeur Mcaste la retransmission
Copyright 2004 by Timur Friedman
58

SRM (2/2)

I but : minimiser le trafic
I un seul membre demande la retransm. I un seul membre retransmet le msg
manquant

hyp : D5, D6 et D7 ont un msg manquant
S1/ D1

I principe

S3/ D3

I envoi des requÃªtes : VORWWLQJ + GDPSLQJ

I Request Timer

S2/ D2

D5

I envoi des retransmissions

D4

I Repair Timer

I difficultÃ©

D6

D7

I dimensionnement des Timers
I estimation du RTT pour chaque paire (Di, Dj)
Copyright 2004 by Timur Friedman

nouveaux msgs r eq. de r et r ansm. r et r ansmissions

59

RMTP

I Reliable Multicast Transport Protocol

I offre une transmission point Ã  multipoint, fiable, avec maintien de sÃ©quence

I idÃ©es S I notion de hiÃ©rarchie

- rÃ©duire lâ€™implosion Ã  la source

- rÃ©duire les temps de rÃ©ponse

DR1

DR2

DR3

I notion de reprise en local

I principe

D DR4

I les rÃ©cepteurs sont groupÃ©s dans des rÃ©gions locales

DD

I il y a un DR ('HVLJQDWHG 5HFHLYHU) par rÃ©gion, chargÃ©
dâ€™agrÃ©ger les msg de status

I difficultÃ© : construire lâ€™arbre logique Copyright 2004 by Timur Friedman

DD

DDD

msg de st at us

60

Plan
I Introduction I Le multicast au niveau rÃ©seau I Le multicast au niveau transport I Perspectives de recherche
I niveau rÃ©seau I niveau transport I niveau application
Copyright 2004 by Timur Friedman
61

Perspectives au niveau rÃ©seau

I adressage et routage j OÂ¶LQWpULHXU dâ€™un groupe

S

S

R1

D1

R2

R3

DDD

R4

D2 R5

R1

D2

R2

R3

DD

R4

R5

DD DDD

D D D D D1

mult icast sur un sous ar br e

unicast ver s un membr e du gr oupe

(Â« subcast ing Â»)

(Â« r eachcast ing Â»)

I routage multicast dans un rÃ©seau mobile

I routage multicast avec QoS

Copyright 2004 by Timur Friedman
62

Perspectives au niveau transport
I contrÃ´le de flux/congestion I fiabilitÃ© assistÃ©e par les routeurs I auto-configuration des membres du groupe
Copyright 2004 by Timur Friedman
63

Perspectives au niveau application
I allocation des adresses multicast I nommage dâ€™objets partagÃ©s
Copyright 2004 by Timur Friedman
64

Bibliographie
I >5)& @ 6 'HHULQJ Â©+RVW ([WHQVLRQVIRU ,3 0XOWLFDVWLQJÂª $XJXVW  I >5)& @ ' :DLW]PDQ 6 'HHULQJ & 3DUWULGJH Â©'LVWDQFH 9HFWRU 0XOWLFDVW 5RXWLQJ 3URWRFROÂª
1RYHPEHU  I >5)& @ - 0R\ Â©0XOWLFDVW ([WHQVLRQV WR 263)Âª 0DUFK  I >5)& @ $ %DOODUGLH Â©&RUH %DVH 7UHHV &%7 9HUVLRQ  0XOWLFDVW 5RXWLQJ 3URWRFRO
6SHFLILFDWLRQÂª 6HSWHPEHU  I >5)& @ $ %DOODUGLH Â©&RUH %DVH 7UHHV &%7 9HUVLRQ  0XOWLFDVW $UFKLWHFWXUHÂª 6HSWHPEHU
 I >5)& @ 5 )HQQHU Â©,QWHUQHW *URXS 0DQDJHPHQW 3URWRFRO 9HUVLRQ Âª 1RYHPEHU  I >5)& @ ' (VWULQ ' )DULQDFFL $ +HOP\ ' 7KDOHU 6 'HHULQJ 0 +DQGOH\ 9 -DFREVRQ & /LX
3 6KDUPD / :HL Â©3URWRFRO ,QGHSHQGHQW 0XOWLFDVW6SDUVH 0RGH 3,060 3URWRFRO 6SHFLILFDWLRQ -XQH  I & 'LRW : 'DEERXV - &URZFURIW Â©0XOWLSRLQW &RPPXQLFDWLRQ $ 6XUYH\ RI 3URWRFROV )XQFWLRQV DQG 0HFKDQLVPVÂª ,((( -6$& 9RO 1Âƒ $SULO  I 6 )OR\G 9 -DFREVRQ 6 0F&DQQH &* /LX / =KDQJ Â©$ 5HOLDEOH 0XOWLFDVW )UDPHZRUN IRU /LJKW ZHLJKW 6HVVLRQV DQG $SSOLFDWLRQV /HYHO )UDPLQJÂª 3URF RI $&0 6,*&200Â¶ 2FWREHU  I 6 3DXO .. 6DEQDQL -& /LQ 6 %KDWWDFKDU\\D Â©5HOLDEOH 0XOWLFDVW 7UDQVSRUW 3URWRFRO 5073Âª ,((( -6$& 9RO 1Âƒ $SULO  I 6 3DXO Â©0XOWLFDVWLQJ RQ WKH ,QWHUQHW DQG LWV $SSOLFDWLRQVÂª .OXZHU $FDGHPLF 3XEOLVKHUV  I KWWSZZZPERQHFRP
Copyright 2004 by Timur Friedman
65

